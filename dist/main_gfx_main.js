(()=>{"use strict";var t={887:(t,e,n)=>{n.r(e),n.d(e,{glMatrix:()=>a,mat2:()=>r,mat2d:()=>i,mat3:()=>s,mat4:()=>o,quat:()=>l,quat2:()=>f,vec2:()=>c,vec3:()=>h,vec4:()=>u});var a={};n.r(a),n.d(a,{ARRAY_TYPE:()=>m,EPSILON:()=>d,RANDOM:()=>p,equals:()=>b,setMatrixArrayType:()=>v,toRadian:()=>g});var r={};n.r(r),n.d(r,{LDU:()=>G,add:()=>z,adjoint:()=>S,clone:()=>y,copy:()=>C,create:()=>x,determinant:()=>A,equals:()=>U,exactEquals:()=>k,frob:()=>I,fromRotation:()=>_,fromScaling:()=>V,fromValues:()=>D,identity:()=>w,invert:()=>T,mul:()=>E,multiply:()=>L,multiplyScalar:()=>N,multiplyScalarAndAdd:()=>R,rotate:()=>O,scale:()=>j,set:()=>B,str:()=>F,sub:()=>X,subtract:()=>q,transpose:()=>P});var i={};n.r(i),n.d(i,{add:()=>ut,clone:()=>Z,copy:()=>H,create:()=>Y,determinant:()=>$,equals:()=>mt,exactEquals:()=>dt,frob:()=>ht,fromRotation:()=>rt,fromScaling:()=>it,fromTranslation:()=>st,fromValues:()=>Q,identity:()=>W,invert:()=>K,mul:()=>pt,multiply:()=>tt,multiplyScalar:()=>ft,multiplyScalarAndAdd:()=>ct,rotate:()=>et,scale:()=>nt,set:()=>J,str:()=>ot,sub:()=>vt,subtract:()=>lt,translate:()=>at});var s={};n.r(s),n.d(s,{add:()=>Ut,adjoint:()=>Pt,clone:()=>bt,copy:()=>xt,create:()=>Mt,determinant:()=>Tt,equals:()=>Yt,exactEquals:()=>Xt,frob:()=>kt,fromMat2d:()=>Ft,fromMat4:()=>gt,fromQuat:()=>It,fromRotation:()=>_t,fromScaling:()=>Vt,fromTranslation:()=>jt,fromValues:()=>yt,identity:()=>wt,invert:()=>Bt,mul:()=>Zt,multiply:()=>St,multiplyScalar:()=>Rt,multiplyScalarAndAdd:()=>Et,normalFromMat4:()=>Gt,projection:()=>zt,rotate:()=>Lt,scale:()=>Ot,set:()=>Ct,str:()=>qt,sub:()=>Ht,subtract:()=>Nt,translate:()=>At,transpose:()=>Dt});var o={};n.r(o),n.d(o,{add:()=>ze,adjoint:()=>ae,clone:()=>Qt,copy:()=>Jt,create:()=>Wt,determinant:()=>re,equals:()=>Re,exactEquals:()=>Ne,frob:()=>Ge,fromQuat:()=>Be,fromQuat2:()=>be,fromRotation:()=>me,fromRotationTranslation:()=>ge,fromRotationTranslationScale:()=>we,fromRotationTranslationScaleOrigin:()=>De,fromScaling:()=>de,fromTranslation:()=>ce,fromValues:()=>Kt,fromXRotation:()=>pe,fromYRotation:()=>ve,fromZRotation:()=>Me,frustum:()=>Pe,getRotation:()=>Ce,getScaling:()=>ye,getTranslation:()=>xe,identity:()=>te,invert:()=>ne,lookAt:()=>Ve,mul:()=>Ee,multiply:()=>ie,multiplyScalar:()=>ke,multiplyScalarAndAdd:()=>Ue,ortho:()=>je,orthoNO:()=>Oe,orthoZO:()=>_e,perspective:()=>Se,perspectiveFromFieldOfView:()=>Le,perspectiveNO:()=>Te,perspectiveZO:()=>Ae,rotate:()=>he,rotateX:()=>ue,rotateY:()=>le,rotateZ:()=>fe,scale:()=>oe,set:()=>$t,str:()=>Ie,sub:()=>Xe,subtract:()=>qe,targetTo:()=>Fe,translate:()=>se,transpose:()=>ee});var h={};n.r(h),n.d(h,{add:()=>Ke,angle:()=>Sn,bezier:()=>xn,ceil:()=>nn,clone:()=>Ze,copy:()=>Qe,create:()=>Ye,cross:()=>Mn,dist:()=>Gn,distance:()=>ln,div:()=>In,divide:()=>en,dot:()=>vn,equals:()=>jn,exactEquals:()=>On,floor:()=>an,forEach:()=>Un,fromValues:()=>We,hermite:()=>bn,inverse:()=>mn,len:()=>qn,length:()=>He,lerp:()=>gn,max:()=>sn,min:()=>rn,mul:()=>Fn,multiply:()=>tn,negate:()=>dn,normalize:()=>pn,random:()=>yn,rotateX:()=>Bn,rotateY:()=>Pn,rotateZ:()=>Tn,round:()=>on,scale:()=>hn,scaleAndAdd:()=>un,set:()=>Je,sqrDist:()=>zn,sqrLen:()=>kn,squaredDistance:()=>fn,squaredLength:()=>cn,str:()=>Ln,sub:()=>Vn,subtract:()=>$e,transformMat3:()=>wn,transformMat4:()=>Cn,transformQuat:()=>Dn,zero:()=>An});var u={};n.r(u),n.d(u,{add:()=>Zn,ceil:()=>Jn,clone:()=>Rn,copy:()=>Xn,create:()=>Nn,cross:()=>ca,dist:()=>Da,distance:()=>ra,div:()=>wa,divide:()=>Qn,dot:()=>fa,equals:()=>xa,exactEquals:()=>ba,floor:()=>Kn,forEach:()=>Sa,fromValues:()=>En,inverse:()=>ua,len:()=>Pa,length:()=>sa,lerp:()=>da,max:()=>ta,min:()=>$n,mul:()=>Ca,multiply:()=>Wn,negate:()=>ha,normalize:()=>la,random:()=>ma,round:()=>ea,scale:()=>na,scaleAndAdd:()=>aa,set:()=>Yn,sqrDist:()=>Ba,sqrLen:()=>Ta,squaredDistance:()=>ia,squaredLength:()=>oa,str:()=>ga,sub:()=>ya,subtract:()=>Hn,transformMat4:()=>pa,transformQuat:()=>va,zero:()=>Ma});var l={};n.r(l),n.d(l,{add:()=>ir,calculateW:()=>za,clone:()=>er,conjugate:()=>Xa,copy:()=>ar,create:()=>Aa,dot:()=>hr,equals:()=>vr,exactEquals:()=>pr,exp:()=>qa,fromEuler:()=>Za,fromMat3:()=>Ya,fromValues:()=>nr,getAngle:()=>_a,getAxisAngle:()=>ja,identity:()=>La,invert:()=>Ea,len:()=>fr,length:()=>lr,lerp:()=>ur,ln:()=>ka,mul:()=>sr,multiply:()=>Va,normalize:()=>mr,pow:()=>Ua,random:()=>Ra,rotateX:()=>Fa,rotateY:()=>Ia,rotateZ:()=>Ga,rotationTo:()=>Mr,scale:()=>or,set:()=>rr,setAxes:()=>br,setAxisAngle:()=>Oa,slerp:()=>Na,sqlerp:()=>gr,sqrLen:()=>dr,squaredLength:()=>cr,str:()=>Ha});var f={};n.r(f),n.d(f,{add:()=>Rr,clone:()=>yr,conjugate:()=>Qr,copy:()=>Sr,create:()=>xr,dot:()=>Zr,equals:()=>ri,exactEquals:()=>ai,fromMat4:()=>Tr,fromRotation:()=>Pr,fromRotationTranslation:()=>Dr,fromRotationTranslationValues:()=>wr,fromTranslation:()=>Br,fromValues:()=>Cr,getDual:()=>jr,getReal:()=>Or,getTranslation:()=>Fr,identity:()=>Ar,invert:()=>Wr,len:()=>Kr,length:()=>Jr,lerp:()=>Hr,mul:()=>Xr,multiply:()=>Er,normalize:()=>ei,rotateAroundAxis:()=>Nr,rotateByQuatAppend:()=>kr,rotateByQuatPrepend:()=>Ur,rotateX:()=>Gr,rotateY:()=>zr,rotateZ:()=>qr,scale:()=>Yr,set:()=>Lr,setDual:()=>Vr,setReal:()=>_r,sqrLen:()=>ti,squaredLength:()=>$r,str:()=>ni,translate:()=>Ir});var c={};n.r(c),n.d(c,{add:()=>li,angle:()=>Gi,ceil:()=>mi,clone:()=>si,copy:()=>hi,create:()=>ii,cross:()=>Ai,dist:()=>Yi,distance:()=>yi,div:()=>Xi,divide:()=>di,dot:()=>Si,equals:()=>Ui,exactEquals:()=>ki,floor:()=>pi,forEach:()=>Wi,fromValues:()=>oi,inverse:()=>Pi,len:()=>Ni,length:()=>wi,lerp:()=>Li,max:()=>Mi,min:()=>vi,mul:()=>Ei,multiply:()=>ci,negate:()=>Bi,normalize:()=>Ti,random:()=>Oi,rotate:()=>Ii,round:()=>gi,scale:()=>bi,scaleAndAdd:()=>xi,set:()=>ui,sqrDist:()=>Zi,sqrLen:()=>Hi,squaredDistance:()=>Ci,squaredLength:()=>Di,str:()=>qi,sub:()=>Ri,subtract:()=>fi,transformMat2:()=>ji,transformMat2d:()=>_i,transformMat3:()=>Vi,transformMat4:()=>Fi,zero:()=>zi});var d=1e-6,m="undefined"!=typeof Float32Array?Float32Array:Array,p=Math.random;function v(t){m=t}var M=Math.PI/180;function g(t){return t*M}function b(t,e){return Math.abs(t-e)<=d*Math.max(1,Math.abs(t),Math.abs(e))}function x(){var t=new m(4);return m!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t}function y(t){var e=new m(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function C(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function w(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function D(t,e,n,a){var r=new m(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=a,r}function B(t,e,n,a,r){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t}function P(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function T(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=n*i-r*a;return s?(s=1/s,t[0]=i*s,t[1]=-a*s,t[2]=-r*s,t[3]=n*s,t):null}function S(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}function A(t){return t[0]*t[3]-t[2]*t[1]}function L(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=n[0],h=n[1],u=n[2],l=n[3];return t[0]=a*o+i*h,t[1]=r*o+s*h,t[2]=a*u+i*l,t[3]=r*u+s*l,t}function O(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=Math.sin(n),h=Math.cos(n);return t[0]=a*h+i*o,t[1]=r*h+s*o,t[2]=a*-o+i*h,t[3]=r*-o+s*h,t}function j(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=n[0],h=n[1];return t[0]=a*o,t[1]=r*o,t[2]=i*h,t[3]=s*h,t}function _(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=-n,t[3]=a,t}function V(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function F(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function I(t){return Math.hypot(t[0],t[1],t[2],t[3])}function G(t,e,n,a){return t[2]=a[2]/a[0],n[0]=a[0],n[1]=a[1],n[3]=a[3]-t[2]*n[1],[t,e,n]}function z(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function q(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function k(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function U(t,e){var n=t[0],a=t[1],r=t[2],i=t[3],s=e[0],o=e[1],h=e[2],u=e[3];return Math.abs(n-s)<=d*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-o)<=d*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(r-h)<=d*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))}function N(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function R(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var E=L,X=q;function Y(){var t=new m(6);return m!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t}function Z(t){var e=new m(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function H(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function W(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function Q(t,e,n,a,r,i){var s=new m(6);return s[0]=t,s[1]=e,s[2]=n,s[3]=a,s[4]=r,s[5]=i,s}function J(t,e,n,a,r,i,s){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=i,t[5]=s,t}function K(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=e[4],o=e[5],h=n*i-a*r;return h?(h=1/h,t[0]=i*h,t[1]=-a*h,t[2]=-r*h,t[3]=n*h,t[4]=(r*o-i*s)*h,t[5]=(a*s-n*o)*h,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=e[4],h=e[5],u=n[0],l=n[1],f=n[2],c=n[3],d=n[4],m=n[5];return t[0]=a*u+i*l,t[1]=r*u+s*l,t[2]=a*f+i*c,t[3]=r*f+s*c,t[4]=a*d+i*m+o,t[5]=r*d+s*m+h,t}function et(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=e[4],h=e[5],u=Math.sin(n),l=Math.cos(n);return t[0]=a*l+i*u,t[1]=r*l+s*u,t[2]=a*-u+i*l,t[3]=r*-u+s*l,t[4]=o,t[5]=h,t}function nt(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=e[4],h=e[5],u=n[0],l=n[1];return t[0]=a*u,t[1]=r*u,t[2]=i*l,t[3]=s*l,t[4]=o,t[5]=h,t}function at(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=e[4],h=e[5],u=n[0],l=n[1];return t[0]=a,t[1]=r,t[2]=i,t[3]=s,t[4]=a*u+i*l+o,t[5]=r*u+s*l+h,t}function rt(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=-n,t[3]=a,t[4]=0,t[5]=0,t}function it(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function st(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function ot(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ht(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)}function ut(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t}function lt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}function ft(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t}function ct(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t}function dt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function mt(t,e){var n=t[0],a=t[1],r=t[2],i=t[3],s=t[4],o=t[5],h=e[0],u=e[1],l=e[2],f=e[3],c=e[4],m=e[5];return Math.abs(n-h)<=d*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(a-u)<=d*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(r-l)<=d*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(i-f)<=d*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(s-c)<=d*Math.max(1,Math.abs(s),Math.abs(c))&&Math.abs(o-m)<=d*Math.max(1,Math.abs(o),Math.abs(m))}var pt=tt,vt=lt;function Mt(){var t=new m(9);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function bt(t){var e=new m(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function xt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function yt(t,e,n,a,r,i,s,o,h){var u=new m(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=a,u[4]=r,u[5]=i,u[6]=s,u[7]=o,u[8]=h,u}function Ct(t,e,n,a,r,i,s,o,h,u){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=i,t[5]=s,t[6]=o,t[7]=h,t[8]=u,t}function wt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Dt(t,e){if(t===e){var n=e[1],a=e[2],r=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=a,t[7]=r}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Bt(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=e[4],o=e[5],h=e[6],u=e[7],l=e[8],f=l*s-o*u,c=-l*i+o*h,d=u*i-s*h,m=n*f+a*c+r*d;return m?(m=1/m,t[0]=f*m,t[1]=(-l*a+r*u)*m,t[2]=(o*a-r*s)*m,t[3]=c*m,t[4]=(l*n-r*h)*m,t[5]=(-o*n+r*i)*m,t[6]=d*m,t[7]=(-u*n+a*h)*m,t[8]=(s*n-a*i)*m,t):null}function Pt(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=e[4],o=e[5],h=e[6],u=e[7],l=e[8];return t[0]=s*l-o*u,t[1]=r*u-a*l,t[2]=a*o-r*s,t[3]=o*h-i*l,t[4]=n*l-r*h,t[5]=r*i-n*o,t[6]=i*u-s*h,t[7]=a*h-n*u,t[8]=n*s-a*i,t}function Tt(t){var e=t[0],n=t[1],a=t[2],r=t[3],i=t[4],s=t[5],o=t[6],h=t[7],u=t[8];return e*(u*i-s*h)+n*(-u*r+s*o)+a*(h*r-i*o)}function St(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=e[4],h=e[5],u=e[6],l=e[7],f=e[8],c=n[0],d=n[1],m=n[2],p=n[3],v=n[4],M=n[5],g=n[6],b=n[7],x=n[8];return t[0]=c*a+d*s+m*u,t[1]=c*r+d*o+m*l,t[2]=c*i+d*h+m*f,t[3]=p*a+v*s+M*u,t[4]=p*r+v*o+M*l,t[5]=p*i+v*h+M*f,t[6]=g*a+b*s+x*u,t[7]=g*r+b*o+x*l,t[8]=g*i+b*h+x*f,t}function At(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=e[4],h=e[5],u=e[6],l=e[7],f=e[8],c=n[0],d=n[1];return t[0]=a,t[1]=r,t[2]=i,t[3]=s,t[4]=o,t[5]=h,t[6]=c*a+d*s+u,t[7]=c*r+d*o+l,t[8]=c*i+d*h+f,t}function Lt(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=e[4],h=e[5],u=e[6],l=e[7],f=e[8],c=Math.sin(n),d=Math.cos(n);return t[0]=d*a+c*s,t[1]=d*r+c*o,t[2]=d*i+c*h,t[3]=d*s-c*a,t[4]=d*o-c*r,t[5]=d*h-c*i,t[6]=u,t[7]=l,t[8]=f,t}function Ot(t,e,n){var a=n[0],r=n[1];return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=r*e[3],t[4]=r*e[4],t[5]=r*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function jt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function _t(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=-n,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Vt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Ft(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function It(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=n+n,o=a+a,h=r+r,u=n*s,l=a*s,f=a*o,c=r*s,d=r*o,m=r*h,p=i*s,v=i*o,M=i*h;return t[0]=1-f-m,t[3]=l-M,t[6]=c+v,t[1]=l+M,t[4]=1-u-m,t[7]=d-p,t[2]=c-v,t[5]=d+p,t[8]=1-u-f,t}function Gt(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=e[4],o=e[5],h=e[6],u=e[7],l=e[8],f=e[9],c=e[10],d=e[11],m=e[12],p=e[13],v=e[14],M=e[15],g=n*o-a*s,b=n*h-r*s,x=n*u-i*s,y=a*h-r*o,C=a*u-i*o,w=r*u-i*h,D=l*p-f*m,B=l*v-c*m,P=l*M-d*m,T=f*v-c*p,S=f*M-d*p,A=c*M-d*v,L=g*A-b*S+x*T+y*P-C*B+w*D;return L?(L=1/L,t[0]=(o*A-h*S+u*T)*L,t[1]=(h*P-s*A-u*B)*L,t[2]=(s*S-o*P+u*D)*L,t[3]=(r*S-a*A-i*T)*L,t[4]=(n*A-r*P+i*B)*L,t[5]=(a*P-n*S-i*D)*L,t[6]=(p*w-v*C+M*y)*L,t[7]=(v*x-m*w-M*b)*L,t[8]=(m*C-p*x+M*g)*L,t):null}function zt(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function qt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function kt(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function Ut(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function Nt(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function Rt(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function Et(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t[6]=e[6]+n[6]*a,t[7]=e[7]+n[7]*a,t[8]=e[8]+n[8]*a,t}function Xt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Yt(t,e){var n=t[0],a=t[1],r=t[2],i=t[3],s=t[4],o=t[5],h=t[6],u=t[7],l=t[8],f=e[0],c=e[1],m=e[2],p=e[3],v=e[4],M=e[5],g=e[6],b=e[7],x=e[8];return Math.abs(n-f)<=d*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(a-c)<=d*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(r-m)<=d*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(i-p)<=d*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(s-v)<=d*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(o-M)<=d*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(h-g)<=d*Math.max(1,Math.abs(h),Math.abs(g))&&Math.abs(u-b)<=d*Math.max(1,Math.abs(u),Math.abs(b))&&Math.abs(l-x)<=d*Math.max(1,Math.abs(l),Math.abs(x))}var Zt=St,Ht=Nt;function Wt(){var t=new m(16);return m!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Qt(t){var e=new m(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Jt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Kt(t,e,n,a,r,i,s,o,h,u,l,f,c,d,p,v){var M=new m(16);return M[0]=t,M[1]=e,M[2]=n,M[3]=a,M[4]=r,M[5]=i,M[6]=s,M[7]=o,M[8]=h,M[9]=u,M[10]=l,M[11]=f,M[12]=c,M[13]=d,M[14]=p,M[15]=v,M}function $t(t,e,n,a,r,i,s,o,h,u,l,f,c,d,m,p,v){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=i,t[5]=s,t[6]=o,t[7]=h,t[8]=u,t[9]=l,t[10]=f,t[11]=c,t[12]=d,t[13]=m,t[14]=p,t[15]=v,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){var n=e[1],a=e[2],r=e[3],i=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=a,t[9]=i,t[11]=e[14],t[12]=r,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ne(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=e[4],o=e[5],h=e[6],u=e[7],l=e[8],f=e[9],c=e[10],d=e[11],m=e[12],p=e[13],v=e[14],M=e[15],g=n*o-a*s,b=n*h-r*s,x=n*u-i*s,y=a*h-r*o,C=a*u-i*o,w=r*u-i*h,D=l*p-f*m,B=l*v-c*m,P=l*M-d*m,T=f*v-c*p,S=f*M-d*p,A=c*M-d*v,L=g*A-b*S+x*T+y*P-C*B+w*D;return L?(L=1/L,t[0]=(o*A-h*S+u*T)*L,t[1]=(r*S-a*A-i*T)*L,t[2]=(p*w-v*C+M*y)*L,t[3]=(c*C-f*w-d*y)*L,t[4]=(h*P-s*A-u*B)*L,t[5]=(n*A-r*P+i*B)*L,t[6]=(v*x-m*w-M*b)*L,t[7]=(l*w-c*x+d*b)*L,t[8]=(s*S-o*P+u*D)*L,t[9]=(a*P-n*S-i*D)*L,t[10]=(m*C-p*x+M*g)*L,t[11]=(f*x-l*C-d*g)*L,t[12]=(o*B-s*T-h*D)*L,t[13]=(n*T-a*B+r*D)*L,t[14]=(p*b-m*y-v*g)*L,t[15]=(l*y-f*b+c*g)*L,t):null}function ae(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=e[4],o=e[5],h=e[6],u=e[7],l=e[8],f=e[9],c=e[10],d=e[11],m=e[12],p=e[13],v=e[14],M=e[15];return t[0]=o*(c*M-d*v)-f*(h*M-u*v)+p*(h*d-u*c),t[1]=-(a*(c*M-d*v)-f*(r*M-i*v)+p*(r*d-i*c)),t[2]=a*(h*M-u*v)-o*(r*M-i*v)+p*(r*u-i*h),t[3]=-(a*(h*d-u*c)-o*(r*d-i*c)+f*(r*u-i*h)),t[4]=-(s*(c*M-d*v)-l*(h*M-u*v)+m*(h*d-u*c)),t[5]=n*(c*M-d*v)-l*(r*M-i*v)+m*(r*d-i*c),t[6]=-(n*(h*M-u*v)-s*(r*M-i*v)+m*(r*u-i*h)),t[7]=n*(h*d-u*c)-s*(r*d-i*c)+l*(r*u-i*h),t[8]=s*(f*M-d*p)-l*(o*M-u*p)+m*(o*d-u*f),t[9]=-(n*(f*M-d*p)-l*(a*M-i*p)+m*(a*d-i*f)),t[10]=n*(o*M-u*p)-s*(a*M-i*p)+m*(a*u-i*o),t[11]=-(n*(o*d-u*f)-s*(a*d-i*f)+l*(a*u-i*o)),t[12]=-(s*(f*v-c*p)-l*(o*v-h*p)+m*(o*c-h*f)),t[13]=n*(f*v-c*p)-l*(a*v-r*p)+m*(a*c-r*f),t[14]=-(n*(o*v-h*p)-s*(a*v-r*p)+m*(a*h-r*o)),t[15]=n*(o*c-h*f)-s*(a*c-r*f)+l*(a*h-r*o),t}function re(t){var e=t[0],n=t[1],a=t[2],r=t[3],i=t[4],s=t[5],o=t[6],h=t[7],u=t[8],l=t[9],f=t[10],c=t[11],d=t[12],m=t[13],p=t[14],v=t[15];return(e*s-n*i)*(f*v-c*p)-(e*o-a*i)*(l*v-c*m)+(e*h-r*i)*(l*p-f*m)+(n*o-a*s)*(u*v-c*d)-(n*h-r*s)*(u*p-f*d)+(a*h-r*o)*(u*m-l*d)}function ie(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=e[4],h=e[5],u=e[6],l=e[7],f=e[8],c=e[9],d=e[10],m=e[11],p=e[12],v=e[13],M=e[14],g=e[15],b=n[0],x=n[1],y=n[2],C=n[3];return t[0]=b*a+x*o+y*f+C*p,t[1]=b*r+x*h+y*c+C*v,t[2]=b*i+x*u+y*d+C*M,t[3]=b*s+x*l+y*m+C*g,b=n[4],x=n[5],y=n[6],C=n[7],t[4]=b*a+x*o+y*f+C*p,t[5]=b*r+x*h+y*c+C*v,t[6]=b*i+x*u+y*d+C*M,t[7]=b*s+x*l+y*m+C*g,b=n[8],x=n[9],y=n[10],C=n[11],t[8]=b*a+x*o+y*f+C*p,t[9]=b*r+x*h+y*c+C*v,t[10]=b*i+x*u+y*d+C*M,t[11]=b*s+x*l+y*m+C*g,b=n[12],x=n[13],y=n[14],C=n[15],t[12]=b*a+x*o+y*f+C*p,t[13]=b*r+x*h+y*c+C*v,t[14]=b*i+x*u+y*d+C*M,t[15]=b*s+x*l+y*m+C*g,t}function se(t,e,n){var a,r,i,s,o,h,u,l,f,c,d,m,p=n[0],v=n[1],M=n[2];return e===t?(t[12]=e[0]*p+e[4]*v+e[8]*M+e[12],t[13]=e[1]*p+e[5]*v+e[9]*M+e[13],t[14]=e[2]*p+e[6]*v+e[10]*M+e[14],t[15]=e[3]*p+e[7]*v+e[11]*M+e[15]):(a=e[0],r=e[1],i=e[2],s=e[3],o=e[4],h=e[5],u=e[6],l=e[7],f=e[8],c=e[9],d=e[10],m=e[11],t[0]=a,t[1]=r,t[2]=i,t[3]=s,t[4]=o,t[5]=h,t[6]=u,t[7]=l,t[8]=f,t[9]=c,t[10]=d,t[11]=m,t[12]=a*p+o*v+f*M+e[12],t[13]=r*p+h*v+c*M+e[13],t[14]=i*p+u*v+d*M+e[14],t[15]=s*p+l*v+m*M+e[15]),t}function oe(t,e,n){var a=n[0],r=n[1],i=n[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function he(t,e,n,a){var r,i,s,o,h,u,l,f,c,m,p,v,M,g,b,x,y,C,w,D,B,P,T,S,A=a[0],L=a[1],O=a[2],j=Math.hypot(A,L,O);return j<d?null:(A*=j=1/j,L*=j,O*=j,r=Math.sin(n),s=1-(i=Math.cos(n)),o=e[0],h=e[1],u=e[2],l=e[3],f=e[4],c=e[5],m=e[6],p=e[7],v=e[8],M=e[9],g=e[10],b=e[11],x=A*A*s+i,y=L*A*s+O*r,C=O*A*s-L*r,w=A*L*s-O*r,D=L*L*s+i,B=O*L*s+A*r,P=A*O*s+L*r,T=L*O*s-A*r,S=O*O*s+i,t[0]=o*x+f*y+v*C,t[1]=h*x+c*y+M*C,t[2]=u*x+m*y+g*C,t[3]=l*x+p*y+b*C,t[4]=o*w+f*D+v*B,t[5]=h*w+c*D+M*B,t[6]=u*w+m*D+g*B,t[7]=l*w+p*D+b*B,t[8]=o*P+f*T+v*S,t[9]=h*P+c*T+M*S,t[10]=u*P+m*T+g*S,t[11]=l*P+p*T+b*S,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ue(t,e,n){var a=Math.sin(n),r=Math.cos(n),i=e[4],s=e[5],o=e[6],h=e[7],u=e[8],l=e[9],f=e[10],c=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=i*r+u*a,t[5]=s*r+l*a,t[6]=o*r+f*a,t[7]=h*r+c*a,t[8]=u*r-i*a,t[9]=l*r-s*a,t[10]=f*r-o*a,t[11]=c*r-h*a,t}function le(t,e,n){var a=Math.sin(n),r=Math.cos(n),i=e[0],s=e[1],o=e[2],h=e[3],u=e[8],l=e[9],f=e[10],c=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*r-u*a,t[1]=s*r-l*a,t[2]=o*r-f*a,t[3]=h*r-c*a,t[8]=i*a+u*r,t[9]=s*a+l*r,t[10]=o*a+f*r,t[11]=h*a+c*r,t}function fe(t,e,n){var a=Math.sin(n),r=Math.cos(n),i=e[0],s=e[1],o=e[2],h=e[3],u=e[4],l=e[5],f=e[6],c=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=i*r+u*a,t[1]=s*r+l*a,t[2]=o*r+f*a,t[3]=h*r+c*a,t[4]=u*r-i*a,t[5]=l*r-s*a,t[6]=f*r-o*a,t[7]=c*r-h*a,t}function ce(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function de(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e,n){var a,r,i,s=n[0],o=n[1],h=n[2],u=Math.hypot(s,o,h);return u<d?null:(s*=u=1/u,o*=u,h*=u,a=Math.sin(e),i=1-(r=Math.cos(e)),t[0]=s*s*i+r,t[1]=o*s*i+h*a,t[2]=h*s*i-o*a,t[3]=0,t[4]=s*o*i-h*a,t[5]=o*o*i+r,t[6]=h*o*i+s*a,t[7]=0,t[8]=s*h*i+o*a,t[9]=o*h*i-s*a,t[10]=h*h*i+r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pe(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Me(t,e){var n=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ge(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=a+a,h=r+r,u=i+i,l=a*o,f=a*h,c=a*u,d=r*h,m=r*u,p=i*u,v=s*o,M=s*h,g=s*u;return t[0]=1-(d+p),t[1]=f+g,t[2]=c-M,t[3]=0,t[4]=f-g,t[5]=1-(l+p),t[6]=m+v,t[7]=0,t[8]=c+M,t[9]=m-v,t[10]=1-(l+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function be(t,e){var n=new m(3),a=-e[0],r=-e[1],i=-e[2],s=e[3],o=e[4],h=e[5],u=e[6],l=e[7],f=a*a+r*r+i*i+s*s;return f>0?(n[0]=2*(o*s+l*a+h*i-u*r)/f,n[1]=2*(h*s+l*r+u*a-o*i)/f,n[2]=2*(u*s+l*i+o*r-h*a)/f):(n[0]=2*(o*s+l*a+h*i-u*r),n[1]=2*(h*s+l*r+u*a-o*i),n[2]=2*(u*s+l*i+o*r-h*a)),ge(t,e,n),t}function xe(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function ye(t,e){var n=e[0],a=e[1],r=e[2],i=e[4],s=e[5],o=e[6],h=e[8],u=e[9],l=e[10];return t[0]=Math.hypot(n,a,r),t[1]=Math.hypot(i,s,o),t[2]=Math.hypot(h,u,l),t}function Ce(t,e){var n=new m(3);ye(n,e);var a=1/n[0],r=1/n[1],i=1/n[2],s=e[0]*a,o=e[1]*r,h=e[2]*i,u=e[4]*a,l=e[5]*r,f=e[6]*i,c=e[8]*a,d=e[9]*r,p=e[10]*i,v=s+l+p,M=0;return v>0?(M=2*Math.sqrt(v+1),t[3]=.25*M,t[0]=(f-d)/M,t[1]=(c-h)/M,t[2]=(o-u)/M):s>l&&s>p?(M=2*Math.sqrt(1+s-l-p),t[3]=(f-d)/M,t[0]=.25*M,t[1]=(o+u)/M,t[2]=(c+h)/M):l>p?(M=2*Math.sqrt(1+l-s-p),t[3]=(c-h)/M,t[0]=(o+u)/M,t[1]=.25*M,t[2]=(f+d)/M):(M=2*Math.sqrt(1+p-s-l),t[3]=(o-u)/M,t[0]=(c+h)/M,t[1]=(f+d)/M,t[2]=.25*M),t}function we(t,e,n,a){var r=e[0],i=e[1],s=e[2],o=e[3],h=r+r,u=i+i,l=s+s,f=r*h,c=r*u,d=r*l,m=i*u,p=i*l,v=s*l,M=o*h,g=o*u,b=o*l,x=a[0],y=a[1],C=a[2];return t[0]=(1-(m+v))*x,t[1]=(c+b)*x,t[2]=(d-g)*x,t[3]=0,t[4]=(c-b)*y,t[5]=(1-(f+v))*y,t[6]=(p+M)*y,t[7]=0,t[8]=(d+g)*C,t[9]=(p-M)*C,t[10]=(1-(f+m))*C,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function De(t,e,n,a,r){var i=e[0],s=e[1],o=e[2],h=e[3],u=i+i,l=s+s,f=o+o,c=i*u,d=i*l,m=i*f,p=s*l,v=s*f,M=o*f,g=h*u,b=h*l,x=h*f,y=a[0],C=a[1],w=a[2],D=r[0],B=r[1],P=r[2],T=(1-(p+M))*y,S=(d+x)*y,A=(m-b)*y,L=(d-x)*C,O=(1-(c+M))*C,j=(v+g)*C,_=(m+b)*w,V=(v-g)*w,F=(1-(c+p))*w;return t[0]=T,t[1]=S,t[2]=A,t[3]=0,t[4]=L,t[5]=O,t[6]=j,t[7]=0,t[8]=_,t[9]=V,t[10]=F,t[11]=0,t[12]=n[0]+D-(T*D+L*B+_*P),t[13]=n[1]+B-(S*D+O*B+V*P),t[14]=n[2]+P-(A*D+j*B+F*P),t[15]=1,t}function Be(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=n+n,o=a+a,h=r+r,u=n*s,l=a*s,f=a*o,c=r*s,d=r*o,m=r*h,p=i*s,v=i*o,M=i*h;return t[0]=1-f-m,t[1]=l+M,t[2]=c-v,t[3]=0,t[4]=l-M,t[5]=1-u-m,t[6]=d+p,t[7]=0,t[8]=c+v,t[9]=d-p,t[10]=1-u-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Pe(t,e,n,a,r,i,s){var o=1/(n-e),h=1/(r-a),u=1/(i-s);return t[0]=2*i*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*i*h,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(r+a)*h,t[10]=(s+i)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*i*2*u,t[15]=0,t}function Te(t,e,n,a,r){var i,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(i=1/(a-r),t[10]=(r+a)*i,t[14]=2*r*a*i):(t[10]=-1,t[14]=-2*a),t}var Se=Te;function Ae(t,e,n,a,r){var i,s=1/Math.tan(e/2);return t[0]=s/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=r&&r!==1/0?(i=1/(a-r),t[10]=r*i,t[14]=r*a*i):(t[10]=-1,t[14]=-a),t}function Le(t,e,n,a){var r=Math.tan(e.upDegrees*Math.PI/180),i=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),h=2/(s+o),u=2/(r+i);return t[0]=h,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(s-o)*h*.5,t[9]=(r-i)*u*.5,t[10]=a/(n-a),t[11]=-1,t[12]=0,t[13]=0,t[14]=a*n/(n-a),t[15]=0,t}function Oe(t,e,n,a,r,i,s){var o=1/(e-n),h=1/(a-r),u=1/(i-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*o,t[13]=(r+a)*h,t[14]=(s+i)*u,t[15]=1,t}var je=Oe;function _e(t,e,n,a,r,i,s){var o=1/(e-n),h=1/(a-r),u=1/(i-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+n)*o,t[13]=(r+a)*h,t[14]=i*u,t[15]=1,t}function Ve(t,e,n,a){var r,i,s,o,h,u,l,f,c,m,p=e[0],v=e[1],M=e[2],g=a[0],b=a[1],x=a[2],y=n[0],C=n[1],w=n[2];return Math.abs(p-y)<d&&Math.abs(v-C)<d&&Math.abs(M-w)<d?te(t):(l=p-y,f=v-C,c=M-w,r=b*(c*=m=1/Math.hypot(l,f,c))-x*(f*=m),i=x*(l*=m)-g*c,s=g*f-b*l,(m=Math.hypot(r,i,s))?(r*=m=1/m,i*=m,s*=m):(r=0,i=0,s=0),o=f*s-c*i,h=c*r-l*s,u=l*i-f*r,(m=Math.hypot(o,h,u))?(o*=m=1/m,h*=m,u*=m):(o=0,h=0,u=0),t[0]=r,t[1]=o,t[2]=l,t[3]=0,t[4]=i,t[5]=h,t[6]=f,t[7]=0,t[8]=s,t[9]=u,t[10]=c,t[11]=0,t[12]=-(r*p+i*v+s*M),t[13]=-(o*p+h*v+u*M),t[14]=-(l*p+f*v+c*M),t[15]=1,t)}function Fe(t,e,n,a){var r=e[0],i=e[1],s=e[2],o=a[0],h=a[1],u=a[2],l=r-n[0],f=i-n[1],c=s-n[2],d=l*l+f*f+c*c;d>0&&(l*=d=1/Math.sqrt(d),f*=d,c*=d);var m=h*c-u*f,p=u*l-o*c,v=o*f-h*l;return(d=m*m+p*p+v*v)>0&&(m*=d=1/Math.sqrt(d),p*=d,v*=d),t[0]=m,t[1]=p,t[2]=v,t[3]=0,t[4]=f*v-c*p,t[5]=c*m-l*v,t[6]=l*p-f*m,t[7]=0,t[8]=l,t[9]=f,t[10]=c,t[11]=0,t[12]=r,t[13]=i,t[14]=s,t[15]=1,t}function Ie(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Ge(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function ze(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function qe(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function ke(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function Ue(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t[4]=e[4]+n[4]*a,t[5]=e[5]+n[5]*a,t[6]=e[6]+n[6]*a,t[7]=e[7]+n[7]*a,t[8]=e[8]+n[8]*a,t[9]=e[9]+n[9]*a,t[10]=e[10]+n[10]*a,t[11]=e[11]+n[11]*a,t[12]=e[12]+n[12]*a,t[13]=e[13]+n[13]*a,t[14]=e[14]+n[14]*a,t[15]=e[15]+n[15]*a,t}function Ne(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function Re(t,e){var n=t[0],a=t[1],r=t[2],i=t[3],s=t[4],o=t[5],h=t[6],u=t[7],l=t[8],f=t[9],c=t[10],m=t[11],p=t[12],v=t[13],M=t[14],g=t[15],b=e[0],x=e[1],y=e[2],C=e[3],w=e[4],D=e[5],B=e[6],P=e[7],T=e[8],S=e[9],A=e[10],L=e[11],O=e[12],j=e[13],_=e[14],V=e[15];return Math.abs(n-b)<=d*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(a-x)<=d*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(r-y)<=d*Math.max(1,Math.abs(r),Math.abs(y))&&Math.abs(i-C)<=d*Math.max(1,Math.abs(i),Math.abs(C))&&Math.abs(s-w)<=d*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(o-D)<=d*Math.max(1,Math.abs(o),Math.abs(D))&&Math.abs(h-B)<=d*Math.max(1,Math.abs(h),Math.abs(B))&&Math.abs(u-P)<=d*Math.max(1,Math.abs(u),Math.abs(P))&&Math.abs(l-T)<=d*Math.max(1,Math.abs(l),Math.abs(T))&&Math.abs(f-S)<=d*Math.max(1,Math.abs(f),Math.abs(S))&&Math.abs(c-A)<=d*Math.max(1,Math.abs(c),Math.abs(A))&&Math.abs(m-L)<=d*Math.max(1,Math.abs(m),Math.abs(L))&&Math.abs(p-O)<=d*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(v-j)<=d*Math.max(1,Math.abs(v),Math.abs(j))&&Math.abs(M-_)<=d*Math.max(1,Math.abs(M),Math.abs(_))&&Math.abs(g-V)<=d*Math.max(1,Math.abs(g),Math.abs(V))}var Ee=ie,Xe=qe;function Ye(){var t=new m(3);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function Ze(t){var e=new m(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function He(t){var e=t[0],n=t[1],a=t[2];return Math.hypot(e,n,a)}function We(t,e,n){var a=new m(3);return a[0]=t,a[1]=e,a[2]=n,a}function Qe(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Je(t,e,n,a){return t[0]=e,t[1]=n,t[2]=a,t}function Ke(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function $e(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function tn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function en(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function nn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function an(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function rn(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function sn(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function on(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function hn(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function un(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t}function ln(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return Math.hypot(n,a,r)}function fn(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2];return n*n+a*a+r*r}function cn(t){var e=t[0],n=t[1],a=t[2];return e*e+n*n+a*a}function dn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function mn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function pn(t,e){var n=e[0],a=e[1],r=e[2],i=n*n+a*a+r*r;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function vn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Mn(t,e,n){var a=e[0],r=e[1],i=e[2],s=n[0],o=n[1],h=n[2];return t[0]=r*h-i*o,t[1]=i*s-a*h,t[2]=a*o-r*s,t}function gn(t,e,n,a){var r=e[0],i=e[1],s=e[2];return t[0]=r+a*(n[0]-r),t[1]=i+a*(n[1]-i),t[2]=s+a*(n[2]-s),t}function bn(t,e,n,a,r,i){var s=i*i,o=s*(2*i-3)+1,h=s*(i-2)+i,u=s*(i-1),l=s*(3-2*i);return t[0]=e[0]*o+n[0]*h+a[0]*u+r[0]*l,t[1]=e[1]*o+n[1]*h+a[1]*u+r[1]*l,t[2]=e[2]*o+n[2]*h+a[2]*u+r[2]*l,t}function xn(t,e,n,a,r,i){var s=1-i,o=s*s,h=i*i,u=o*s,l=3*i*o,f=3*h*s,c=h*i;return t[0]=e[0]*u+n[0]*l+a[0]*f+r[0]*c,t[1]=e[1]*u+n[1]*l+a[1]*f+r[1]*c,t[2]=e[2]*u+n[2]*l+a[2]*f+r[2]*c,t}function yn(t,e){e=e||1;var n=2*p()*Math.PI,a=2*p()-1,r=Math.sqrt(1-a*a)*e;return t[0]=Math.cos(n)*r,t[1]=Math.sin(n)*r,t[2]=a*e,t}function Cn(t,e,n){var a=e[0],r=e[1],i=e[2],s=n[3]*a+n[7]*r+n[11]*i+n[15];return s=s||1,t[0]=(n[0]*a+n[4]*r+n[8]*i+n[12])/s,t[1]=(n[1]*a+n[5]*r+n[9]*i+n[13])/s,t[2]=(n[2]*a+n[6]*r+n[10]*i+n[14])/s,t}function wn(t,e,n){var a=e[0],r=e[1],i=e[2];return t[0]=a*n[0]+r*n[3]+i*n[6],t[1]=a*n[1]+r*n[4]+i*n[7],t[2]=a*n[2]+r*n[5]+i*n[8],t}function Dn(t,e,n){var a=n[0],r=n[1],i=n[2],s=n[3],o=e[0],h=e[1],u=e[2],l=r*u-i*h,f=i*o-a*u,c=a*h-r*o,d=r*c-i*f,m=i*l-a*c,p=a*f-r*l,v=2*s;return l*=v,f*=v,c*=v,d*=2,m*=2,p*=2,t[0]=o+l+d,t[1]=h+f+m,t[2]=u+c+p,t}function Bn(t,e,n,a){var r=[],i=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],i[0]=r[0],i[1]=r[1]*Math.cos(a)-r[2]*Math.sin(a),i[2]=r[1]*Math.sin(a)+r[2]*Math.cos(a),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Pn(t,e,n,a){var r=[],i=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],i[0]=r[2]*Math.sin(a)+r[0]*Math.cos(a),i[1]=r[1],i[2]=r[2]*Math.cos(a)-r[0]*Math.sin(a),t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Tn(t,e,n,a){var r=[],i=[];return r[0]=e[0]-n[0],r[1]=e[1]-n[1],r[2]=e[2]-n[2],i[0]=r[0]*Math.cos(a)-r[1]*Math.sin(a),i[1]=r[0]*Math.sin(a)+r[1]*Math.cos(a),i[2]=r[2],t[0]=i[0]+n[0],t[1]=i[1]+n[1],t[2]=i[2]+n[2],t}function Sn(t,e){var n=t[0],a=t[1],r=t[2],i=e[0],s=e[1],o=e[2],h=Math.sqrt(n*n+a*a+r*r)*Math.sqrt(i*i+s*s+o*o),u=h&&vn(t,e)/h;return Math.acos(Math.min(Math.max(u,-1),1))}function An(t){return t[0]=0,t[1]=0,t[2]=0,t}function Ln(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function On(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function jn(t,e){var n=t[0],a=t[1],r=t[2],i=e[0],s=e[1],o=e[2];return Math.abs(n-i)<=d*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(a-s)<=d*Math.max(1,Math.abs(a),Math.abs(s))&&Math.abs(r-o)<=d*Math.max(1,Math.abs(r),Math.abs(o))}var _n,Vn=$e,Fn=tn,In=en,Gn=ln,zn=fn,qn=He,kn=cn,Un=(_n=Ye(),function(t,e,n,a,r,i){var s,o;for(e||(e=3),n||(n=0),o=a?Math.min(a*e+n,t.length):t.length,s=n;s<o;s+=e)_n[0]=t[s],_n[1]=t[s+1],_n[2]=t[s+2],r(_n,_n,i),t[s]=_n[0],t[s+1]=_n[1],t[s+2]=_n[2];return t});function Nn(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function Rn(t){var e=new m(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function En(t,e,n,a){var r=new m(4);return r[0]=t,r[1]=e,r[2]=n,r[3]=a,r}function Xn(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Yn(t,e,n,a,r){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t}function Zn(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function Hn(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function Wn(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function Qn(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function Jn(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Kn(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function $n(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function ta(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function ea(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function na(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function aa(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t[2]=e[2]+n[2]*a,t[3]=e[3]+n[3]*a,t}function ra(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2],i=e[3]-t[3];return Math.hypot(n,a,r,i)}function ia(t,e){var n=e[0]-t[0],a=e[1]-t[1],r=e[2]-t[2],i=e[3]-t[3];return n*n+a*a+r*r+i*i}function sa(t){var e=t[0],n=t[1],a=t[2],r=t[3];return Math.hypot(e,n,a,r)}function oa(t){var e=t[0],n=t[1],a=t[2],r=t[3];return e*e+n*n+a*a+r*r}function ha(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function ua(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function la(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=n*n+a*a+r*r+i*i;return s>0&&(s=1/Math.sqrt(s)),t[0]=n*s,t[1]=a*s,t[2]=r*s,t[3]=i*s,t}function fa(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function ca(t,e,n,a){var r=n[0]*a[1]-n[1]*a[0],i=n[0]*a[2]-n[2]*a[0],s=n[0]*a[3]-n[3]*a[0],o=n[1]*a[2]-n[2]*a[1],h=n[1]*a[3]-n[3]*a[1],u=n[2]*a[3]-n[3]*a[2],l=e[0],f=e[1],c=e[2],d=e[3];return t[0]=f*u-c*h+d*o,t[1]=-l*u+c*s-d*i,t[2]=l*h-f*s+d*r,t[3]=-l*o+f*i-c*r,t}function da(t,e,n,a){var r=e[0],i=e[1],s=e[2],o=e[3];return t[0]=r+a*(n[0]-r),t[1]=i+a*(n[1]-i),t[2]=s+a*(n[2]-s),t[3]=o+a*(n[3]-o),t}function ma(t,e){var n,a,r,i,s,o;e=e||1;do{s=(n=2*p()-1)*n+(a=2*p()-1)*a}while(s>=1);do{o=(r=2*p()-1)*r+(i=2*p()-1)*i}while(o>=1);var h=Math.sqrt((1-s)/o);return t[0]=e*n,t[1]=e*a,t[2]=e*r*h,t[3]=e*i*h,t}function pa(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3];return t[0]=n[0]*a+n[4]*r+n[8]*i+n[12]*s,t[1]=n[1]*a+n[5]*r+n[9]*i+n[13]*s,t[2]=n[2]*a+n[6]*r+n[10]*i+n[14]*s,t[3]=n[3]*a+n[7]*r+n[11]*i+n[15]*s,t}function va(t,e,n){var a=e[0],r=e[1],i=e[2],s=n[0],o=n[1],h=n[2],u=n[3],l=u*a+o*i-h*r,f=u*r+h*a-s*i,c=u*i+s*r-o*a,d=-s*a-o*r-h*i;return t[0]=l*u+d*-s+f*-h-c*-o,t[1]=f*u+d*-o+c*-s-l*-h,t[2]=c*u+d*-h+l*-o-f*-s,t[3]=e[3],t}function Ma(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function ga(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function ba(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function xa(t,e){var n=t[0],a=t[1],r=t[2],i=t[3],s=e[0],o=e[1],h=e[2],u=e[3];return Math.abs(n-s)<=d*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(a-o)<=d*Math.max(1,Math.abs(a),Math.abs(o))&&Math.abs(r-h)<=d*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(i-u)<=d*Math.max(1,Math.abs(i),Math.abs(u))}var ya=Hn,Ca=Wn,wa=Qn,Da=ra,Ba=ia,Pa=sa,Ta=oa,Sa=function(){var t=Nn();return function(e,n,a,r,i,s){var o,h;for(n||(n=4),a||(a=0),h=r?Math.min(r*n+a,e.length):e.length,o=a;o<h;o+=n)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],i(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}();function Aa(){var t=new m(4);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function La(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Oa(t,e,n){n*=.5;var a=Math.sin(n);return t[0]=a*e[0],t[1]=a*e[1],t[2]=a*e[2],t[3]=Math.cos(n),t}function ja(t,e){var n=2*Math.acos(e[3]),a=Math.sin(n/2);return a>d?(t[0]=e[0]/a,t[1]=e[1]/a,t[2]=e[2]/a):(t[0]=1,t[1]=0,t[2]=0),n}function _a(t,e){var n=hr(t,e);return Math.acos(2*n*n-1)}function Va(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=n[0],h=n[1],u=n[2],l=n[3];return t[0]=a*l+s*o+r*u-i*h,t[1]=r*l+s*h+i*o-a*u,t[2]=i*l+s*u+a*h-r*o,t[3]=s*l-a*o-r*h-i*u,t}function Fa(t,e,n){n*=.5;var a=e[0],r=e[1],i=e[2],s=e[3],o=Math.sin(n),h=Math.cos(n);return t[0]=a*h+s*o,t[1]=r*h+i*o,t[2]=i*h-r*o,t[3]=s*h-a*o,t}function Ia(t,e,n){n*=.5;var a=e[0],r=e[1],i=e[2],s=e[3],o=Math.sin(n),h=Math.cos(n);return t[0]=a*h-i*o,t[1]=r*h+s*o,t[2]=i*h+a*o,t[3]=s*h-r*o,t}function Ga(t,e,n){n*=.5;var a=e[0],r=e[1],i=e[2],s=e[3],o=Math.sin(n),h=Math.cos(n);return t[0]=a*h+r*o,t[1]=r*h-a*o,t[2]=i*h+s*o,t[3]=s*h-i*o,t}function za(t,e){var n=e[0],a=e[1],r=e[2];return t[0]=n,t[1]=a,t[2]=r,t[3]=Math.sqrt(Math.abs(1-n*n-a*a-r*r)),t}function qa(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=Math.sqrt(n*n+a*a+r*r),o=Math.exp(i),h=s>0?o*Math.sin(s)/s:0;return t[0]=n*h,t[1]=a*h,t[2]=r*h,t[3]=o*Math.cos(s),t}function ka(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=Math.sqrt(n*n+a*a+r*r),o=s>0?Math.atan2(s,i)/s:0;return t[0]=n*o,t[1]=a*o,t[2]=r*o,t[3]=.5*Math.log(n*n+a*a+r*r+i*i),t}function Ua(t,e,n){return ka(t,e),or(t,t,n),qa(t,t),t}function Na(t,e,n,a){var r,i,s,o,h,u=e[0],l=e[1],f=e[2],c=e[3],m=n[0],p=n[1],v=n[2],M=n[3];return(i=u*m+l*p+f*v+c*M)<0&&(i=-i,m=-m,p=-p,v=-v,M=-M),1-i>d?(r=Math.acos(i),s=Math.sin(r),o=Math.sin((1-a)*r)/s,h=Math.sin(a*r)/s):(o=1-a,h=a),t[0]=o*u+h*m,t[1]=o*l+h*p,t[2]=o*f+h*v,t[3]=o*c+h*M,t}function Ra(t){var e=p(),n=p(),a=p(),r=Math.sqrt(1-e),i=Math.sqrt(e);return t[0]=r*Math.sin(2*Math.PI*n),t[1]=r*Math.cos(2*Math.PI*n),t[2]=i*Math.sin(2*Math.PI*a),t[3]=i*Math.cos(2*Math.PI*a),t}function Ea(t,e){var n=e[0],a=e[1],r=e[2],i=e[3],s=n*n+a*a+r*r+i*i,o=s?1/s:0;return t[0]=-n*o,t[1]=-a*o,t[2]=-r*o,t[3]=i*o,t}function Xa(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Ya(t,e){var n,a=e[0]+e[4]+e[8];if(a>0)n=Math.sqrt(a+1),t[3]=.5*n,n=.5/n,t[0]=(e[5]-e[7])*n,t[1]=(e[6]-e[2])*n,t[2]=(e[1]-e[3])*n;else{var r=0;e[4]>e[0]&&(r=1),e[8]>e[3*r+r]&&(r=2);var i=(r+1)%3,s=(r+2)%3;n=Math.sqrt(e[3*r+r]-e[3*i+i]-e[3*s+s]+1),t[r]=.5*n,n=.5/n,t[3]=(e[3*i+s]-e[3*s+i])*n,t[i]=(e[3*i+r]+e[3*r+i])*n,t[s]=(e[3*s+r]+e[3*r+s])*n}return t}function Za(t,e,n,a){var r=.5*Math.PI/180;e*=r,n*=r,a*=r;var i=Math.sin(e),s=Math.cos(e),o=Math.sin(n),h=Math.cos(n),u=Math.sin(a),l=Math.cos(a);return t[0]=i*h*l-s*o*u,t[1]=s*o*l+i*h*u,t[2]=s*h*u-i*o*l,t[3]=s*h*l+i*o*u,t}function Ha(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var Wa,Qa,Ja,Ka,$a,tr,er=Rn,nr=En,ar=Xn,rr=Yn,ir=Zn,sr=Va,or=na,hr=fa,ur=da,lr=sa,fr=lr,cr=oa,dr=cr,mr=la,pr=ba,vr=xa,Mr=(Wa=Ye(),Qa=We(1,0,0),Ja=We(0,1,0),function(t,e,n){var a=vn(e,n);return a<-.999999?(Mn(Wa,Qa,e),qn(Wa)<1e-6&&Mn(Wa,Ja,e),pn(Wa,Wa),Oa(t,Wa,Math.PI),t):a>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(Mn(Wa,e,n),t[0]=Wa[0],t[1]=Wa[1],t[2]=Wa[2],t[3]=1+a,mr(t,t))}),gr=(Ka=Aa(),$a=Aa(),function(t,e,n,a,r,i){return Na(Ka,e,r,i),Na($a,n,a,i),Na(t,Ka,$a,2*i*(1-i)),t}),br=(tr=Mt(),function(t,e,n,a){return tr[0]=n[0],tr[3]=n[1],tr[6]=n[2],tr[1]=a[0],tr[4]=a[1],tr[7]=a[2],tr[2]=-e[0],tr[5]=-e[1],tr[8]=-e[2],mr(t,Ya(t,tr))});function xr(){var t=new m(8);return m!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t}function yr(t){var e=new m(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function Cr(t,e,n,a,r,i,s,o){var h=new m(8);return h[0]=t,h[1]=e,h[2]=n,h[3]=a,h[4]=r,h[5]=i,h[6]=s,h[7]=o,h}function wr(t,e,n,a,r,i,s){var o=new m(8);o[0]=t,o[1]=e,o[2]=n,o[3]=a;var h=.5*r,u=.5*i,l=.5*s;return o[4]=h*a+u*n-l*e,o[5]=u*a+l*t-h*n,o[6]=l*a+h*e-u*t,o[7]=-h*t-u*e-l*n,o}function Dr(t,e,n){var a=.5*n[0],r=.5*n[1],i=.5*n[2],s=e[0],o=e[1],h=e[2],u=e[3];return t[0]=s,t[1]=o,t[2]=h,t[3]=u,t[4]=a*u+r*h-i*o,t[5]=r*u+i*s-a*h,t[6]=i*u+a*o-r*s,t[7]=-a*s-r*o-i*h,t}function Br(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function Pr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Tr(t,e){var n=Aa();Ce(n,e);var a=new m(3);return xe(a,e),Dr(t,n,a),t}function Sr(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function Ar(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function Lr(t,e,n,a,r,i,s,o,h){return t[0]=e,t[1]=n,t[2]=a,t[3]=r,t[4]=i,t[5]=s,t[6]=o,t[7]=h,t}var Or=ar;function jr(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}var _r=ar;function Vr(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function Fr(t,e){var n=e[4],a=e[5],r=e[6],i=e[7],s=-e[0],o=-e[1],h=-e[2],u=e[3];return t[0]=2*(n*u+i*s+a*h-r*o),t[1]=2*(a*u+i*o+r*s-n*h),t[2]=2*(r*u+i*h+n*o-a*s),t}function Ir(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=.5*n[0],h=.5*n[1],u=.5*n[2],l=e[4],f=e[5],c=e[6],d=e[7];return t[0]=a,t[1]=r,t[2]=i,t[3]=s,t[4]=s*o+r*u-i*h+l,t[5]=s*h+i*o-a*u+f,t[6]=s*u+a*h-r*o+c,t[7]=-a*o-r*h-i*u+d,t}function Gr(t,e,n){var a=-e[0],r=-e[1],i=-e[2],s=e[3],o=e[4],h=e[5],u=e[6],l=e[7],f=o*s+l*a+h*i-u*r,c=h*s+l*r+u*a-o*i,d=u*s+l*i+o*r-h*a,m=l*s-o*a-h*r-u*i;return Fa(t,e,n),a=t[0],r=t[1],i=t[2],s=t[3],t[4]=f*s+m*a+c*i-d*r,t[5]=c*s+m*r+d*a-f*i,t[6]=d*s+m*i+f*r-c*a,t[7]=m*s-f*a-c*r-d*i,t}function zr(t,e,n){var a=-e[0],r=-e[1],i=-e[2],s=e[3],o=e[4],h=e[5],u=e[6],l=e[7],f=o*s+l*a+h*i-u*r,c=h*s+l*r+u*a-o*i,d=u*s+l*i+o*r-h*a,m=l*s-o*a-h*r-u*i;return Ia(t,e,n),a=t[0],r=t[1],i=t[2],s=t[3],t[4]=f*s+m*a+c*i-d*r,t[5]=c*s+m*r+d*a-f*i,t[6]=d*s+m*i+f*r-c*a,t[7]=m*s-f*a-c*r-d*i,t}function qr(t,e,n){var a=-e[0],r=-e[1],i=-e[2],s=e[3],o=e[4],h=e[5],u=e[6],l=e[7],f=o*s+l*a+h*i-u*r,c=h*s+l*r+u*a-o*i,d=u*s+l*i+o*r-h*a,m=l*s-o*a-h*r-u*i;return Ga(t,e,n),a=t[0],r=t[1],i=t[2],s=t[3],t[4]=f*s+m*a+c*i-d*r,t[5]=c*s+m*r+d*a-f*i,t[6]=d*s+m*i+f*r-c*a,t[7]=m*s-f*a-c*r-d*i,t}function kr(t,e,n){var a=n[0],r=n[1],i=n[2],s=n[3],o=e[0],h=e[1],u=e[2],l=e[3];return t[0]=o*s+l*a+h*i-u*r,t[1]=h*s+l*r+u*a-o*i,t[2]=u*s+l*i+o*r-h*a,t[3]=l*s-o*a-h*r-u*i,o=e[4],h=e[5],u=e[6],l=e[7],t[4]=o*s+l*a+h*i-u*r,t[5]=h*s+l*r+u*a-o*i,t[6]=u*s+l*i+o*r-h*a,t[7]=l*s-o*a-h*r-u*i,t}function Ur(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=n[0],h=n[1],u=n[2],l=n[3];return t[0]=a*l+s*o+r*u-i*h,t[1]=r*l+s*h+i*o-a*u,t[2]=i*l+s*u+a*h-r*o,t[3]=s*l-a*o-r*h-i*u,o=n[4],h=n[5],u=n[6],l=n[7],t[4]=a*l+s*o+r*u-i*h,t[5]=r*l+s*h+i*o-a*u,t[6]=i*l+s*u+a*h-r*o,t[7]=s*l-a*o-r*h-i*u,t}function Nr(t,e,n,a){if(Math.abs(a)<d)return Sr(t,e);var r=Math.hypot(n[0],n[1],n[2]);a*=.5;var i=Math.sin(a),s=i*n[0]/r,o=i*n[1]/r,h=i*n[2]/r,u=Math.cos(a),l=e[0],f=e[1],c=e[2],m=e[3];t[0]=l*u+m*s+f*h-c*o,t[1]=f*u+m*o+c*s-l*h,t[2]=c*u+m*h+l*o-f*s,t[3]=m*u-l*s-f*o-c*h;var p=e[4],v=e[5],M=e[6],g=e[7];return t[4]=p*u+g*s+v*h-M*o,t[5]=v*u+g*o+M*s-p*h,t[6]=M*u+g*h+p*o-v*s,t[7]=g*u-p*s-v*o-M*h,t}function Rr(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t}function Er(t,e,n){var a=e[0],r=e[1],i=e[2],s=e[3],o=n[4],h=n[5],u=n[6],l=n[7],f=e[4],c=e[5],d=e[6],m=e[7],p=n[0],v=n[1],M=n[2],g=n[3];return t[0]=a*g+s*p+r*M-i*v,t[1]=r*g+s*v+i*p-a*M,t[2]=i*g+s*M+a*v-r*p,t[3]=s*g-a*p-r*v-i*M,t[4]=a*l+s*o+r*u-i*h+f*g+m*p+c*M-d*v,t[5]=r*l+s*h+i*o-a*u+c*g+m*v+d*p-f*M,t[6]=i*l+s*u+a*h-r*o+d*g+m*M+f*v-c*p,t[7]=s*l-a*o-r*h-i*u+m*g-f*p-c*v-d*M,t}var Xr=Er;function Yr(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t}var Zr=hr;function Hr(t,e,n,a){var r=1-a;return Zr(e,n)<0&&(a=-a),t[0]=e[0]*r+n[0]*a,t[1]=e[1]*r+n[1]*a,t[2]=e[2]*r+n[2]*a,t[3]=e[3]*r+n[3]*a,t[4]=e[4]*r+n[4]*a,t[5]=e[5]*r+n[5]*a,t[6]=e[6]*r+n[6]*a,t[7]=e[7]*r+n[7]*a,t}function Wr(t,e){var n=$r(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t}function Qr(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}var Jr=lr,Kr=Jr,$r=cr,ti=$r;function ei(t,e){var n=$r(e);if(n>0){n=Math.sqrt(n);var a=e[0]/n,r=e[1]/n,i=e[2]/n,s=e[3]/n,o=e[4],h=e[5],u=e[6],l=e[7],f=a*o+r*h+i*u+s*l;t[0]=a,t[1]=r,t[2]=i,t[3]=s,t[4]=(o-a*f)/n,t[5]=(h-r*f)/n,t[6]=(u-i*f)/n,t[7]=(l-s*f)/n}return t}function ni(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function ai(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function ri(t,e){var n=t[0],a=t[1],r=t[2],i=t[3],s=t[4],o=t[5],h=t[6],u=t[7],l=e[0],f=e[1],c=e[2],m=e[3],p=e[4],v=e[5],M=e[6],g=e[7];return Math.abs(n-l)<=d*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-f)<=d*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(r-c)<=d*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-m)<=d*Math.max(1,Math.abs(i),Math.abs(m))&&Math.abs(s-p)<=d*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(o-v)<=d*Math.max(1,Math.abs(o),Math.abs(v))&&Math.abs(h-M)<=d*Math.max(1,Math.abs(h),Math.abs(M))&&Math.abs(u-g)<=d*Math.max(1,Math.abs(u),Math.abs(g))}function ii(){var t=new m(2);return m!=Float32Array&&(t[0]=0,t[1]=0),t}function si(t){var e=new m(2);return e[0]=t[0],e[1]=t[1],e}function oi(t,e){var n=new m(2);return n[0]=t,n[1]=e,n}function hi(t,e){return t[0]=e[0],t[1]=e[1],t}function ui(t,e,n){return t[0]=e,t[1]=n,t}function li(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function fi(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function ci(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function di(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function mi(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function pi(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function vi(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function Mi(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function gi(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function bi(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function xi(t,e,n,a){return t[0]=e[0]+n[0]*a,t[1]=e[1]+n[1]*a,t}function yi(t,e){var n=e[0]-t[0],a=e[1]-t[1];return Math.hypot(n,a)}function Ci(t,e){var n=e[0]-t[0],a=e[1]-t[1];return n*n+a*a}function wi(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Di(t){var e=t[0],n=t[1];return e*e+n*n}function Bi(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Pi(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Ti(t,e){var n=e[0],a=e[1],r=n*n+a*a;return r>0&&(r=1/Math.sqrt(r)),t[0]=e[0]*r,t[1]=e[1]*r,t}function Si(t,e){return t[0]*e[0]+t[1]*e[1]}function Ai(t,e,n){var a=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=a,t}function Li(t,e,n,a){var r=e[0],i=e[1];return t[0]=r+a*(n[0]-r),t[1]=i+a*(n[1]-i),t}function Oi(t,e){e=e||1;var n=2*p()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function ji(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[2]*r,t[1]=n[1]*a+n[3]*r,t}function _i(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[2]*r+n[4],t[1]=n[1]*a+n[3]*r+n[5],t}function Vi(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[3]*r+n[6],t[1]=n[1]*a+n[4]*r+n[7],t}function Fi(t,e,n){var a=e[0],r=e[1];return t[0]=n[0]*a+n[4]*r+n[12],t[1]=n[1]*a+n[5]*r+n[13],t}function Ii(t,e,n,a){var r=e[0]-n[0],i=e[1]-n[1],s=Math.sin(a),o=Math.cos(a);return t[0]=r*o-i*s+n[0],t[1]=r*s+i*o+n[1],t}function Gi(t,e){var n=t[0],a=t[1],r=e[0],i=e[1],s=Math.sqrt(n*n+a*a)*Math.sqrt(r*r+i*i),o=s&&(n*r+a*i)/s;return Math.acos(Math.min(Math.max(o,-1),1))}function zi(t){return t[0]=0,t[1]=0,t}function qi(t){return"vec2("+t[0]+", "+t[1]+")"}function ki(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ui(t,e){var n=t[0],a=t[1],r=e[0],i=e[1];return Math.abs(n-r)<=d*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(a-i)<=d*Math.max(1,Math.abs(a),Math.abs(i))}var Ni=wi,Ri=fi,Ei=ci,Xi=di,Yi=yi,Zi=Ci,Hi=Di,Wi=function(){var t=ii();return function(e,n,a,r,i,s){var o,h;for(n||(n=2),a||(a=0),h=r?Math.min(r*n+a,e.length):e.length,o=a;o<h;o+=n)t[0]=e[o],t[1]=e[o+1],i(t,t,s),e[o]=t[0],e[o+1]=t[1];return e}}()},136:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;const a=n(460),r=n(887);class i extends a.MainObject{constructor(){super(),this.extendsCamera=!0,this.type="Camera",this.target=r.vec3.create(),this.inverseModelMatrix=r.mat4.create(),this.projectionMatrix=r.mat4.create(),this.inverseViewProjMatrix=r.mat4.create()}update(){this.updateModel()}updateModel(){this.transformed&&(this.lookAt(this.target),r.mat4.invert(this.inverseModelMatrix,this.model),r.mat4.multiply(this.inverseViewProjMatrix,this.projectionMatrix,this.model),r.mat4.invert(this.inverseViewProjMatrix,this.inverseViewProjMatrix),this.transformed=!1)}setTarget(t){this.target=t}getWorldPosition(){let t=r.vec3.create();return r.vec3.transformMat4(t,this.position,this.inverseModelMatrix),t}}e.Camera=i},594:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.FrustumViewCamera=void 0;const a=n(136);class r extends a.Camera{constructor(t=45,e=1,n=.1,a=100){super(),this.extendsFrustumViewCamera=!0,this.type="FrustumViewCamera",this.fov=t,this.aspect=e,this.near=n,this.far=a,this.updateProjectionMatrix()}updateProjectionMatrix(){const t=Math.tan(this.fov/2),e=this.far-this.near;this.projectionMatrix[0]=1/(this.aspect*t),this.projectionMatrix[5]=1/t,this.projectionMatrix[10]=-(this.far+this.near)/e,this.projectionMatrix[11]=-1,this.projectionMatrix[14]=-2*this.far*this.near/e,this.projectionMatrix[15]=0}}e.FrustumViewCamera=r},810:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Plane=void 0;const a=n(780);class r extends a.PlaneBasedObject{constructor(t=1,e=1,n=1,a=1){super(),this.extendsPlane=!0,this.type="Plane",this.width=t,this.height=e,this.tessellationWidth=n,this.tessellationHeight=a,this.buildPlane(0,1,2,1,-1,t,e,0,n,a,0)}}e.Plane=r},646:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Sphere=void 0;const a=n(644),r=n(887);class i extends a.BufferObject{constructor(t=1,e=64,n=32,a=0,r=2*Math.PI,i=0,s=Math.PI){super(),this.extendsSphere=!0,this.type="Sphere",this.cullMode="back",this.radius=t,this.tessellationWidth=Math.max(3,e),this.tessellationHeight=Math.max(2,n),this.phiStart=a,this.phiEnd=r,this.thetaStart=i,this.thetaEnd=s,this.makeSphere()}makeSphere(){const t=[];for(let e=0;e<=this.tessellationHeight;e++){const n=[],a=e/this.tessellationHeight,i=a*(this.thetaEnd-this.thetaStart)+this.thetaStart,s=Math.sin(i),o=Math.cos(i);for(let t=0;t<=this.tessellationWidth;t++){const e=t/this.tessellationWidth,i=e*(this.phiEnd-this.phiStart)+this.phiStart,h=Math.sin(i),u=Math.cos(i),l=[-this.radius*u*s,this.radius*o,this.radius*h*s],f=r.vec3.normalize(r.vec3.create(),l);this.addVertex3(l),this.addNormal3(f),this.addUV2([e,1-a]),n.push(this.bufferData.position.length/3-1)}t.push(n)}for(let e=0;e<this.tessellationHeight;e++){const n=e+1;for(let a=0;a<this.tessellationWidth;a++){const r=a+1,i=t[e][r],s=t[e][a],o=t[n][a],h=t[n][r];(0!==e||this.thetaStart>0)&&this.addIndex([i,s,h]),(e!==this.tessellationHeight-1||this.thetaEnd<Math.PI)&&this.addIndex([s,o,h])}}}}e.Sphere=i},191:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Light=void 0;const a=n(524),r=n(460);class i extends r.MainObject{constructor(t=new a.Color,e=1){super(),this.extendsLight=!0,this.type="Light",this.color=t,this.intensity=e}update(){}}e.Light=i},237:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PointLight=void 0;const a=n(191),r=n(524),i=n(629);class s extends a.Light{constructor(t=new r.Color,e=1,n=[1,.045,.0075],a=i.AttenuationType.Quadratic,s=1/0){super(t,e),this.extendsPointLight=!0,this.type="PointLight",this.attenuation=n,this.attenuationType=a,this.range=s}getLightData(){return{dir:[0,0,0],sourceType:2,color:this.color.getVec3Intensity(this.intensity),angle:0,pos:this.position,penumbra:0,falloffFunc:this.attenuation,falloffType:this.attenuationType,range:this.range}}}e.PointLight=s},834:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SpotLight=void 0;const a=n(191),r=n(524),i=n(629);class s extends a.Light{constructor(t=new r.Color,e=1,n=[0,0,0],a=[1,.045,.0075],s=i.AttenuationType.Quadratic,o=1/0,h=Math.PI/3,u=Math.PI/6){super(t,e),this.extendsSpotLight=!0,this.type="SpotLight",this.direction=n,this.attenuation=a,this.attenuationType=s,this.range=o,this.angle=h,this.penumbra=u}getLightData(){return{dir:this.direction,sourceType:3,color:this.color.getVec3Intensity(this.intensity),angle:this.angle,pos:this.position,penumbra:this.penumbra,falloffFunc:this.attenuation,falloffType:this.attenuationType,range:this.range}}}e.SpotLight=s},930:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Material=void 0,e.Material=class{constructor(){this.extendsMaterial=!0,this.type="Material",this.opacity=1,this.visible=!0}}},825:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NormalMaterial=void 0;const a=n(930);class r extends a.Material{constructor(){super(),this.extendsNormalMaterial=!0,this.type="NormalMaterial",this.shaderType="fs_normal"}getMaterialData(t){return new Float32Array(0)}}e.NormalMaterial=r},616:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PhongMaterial=void 0;const a=n(524),r=n(126);class i extends r.TexturedMaterial{constructor(t=new a.Color(1,1,1),e=1,n=new a.Color(1,1,1),r=16,i=new a.Color(0,0,0),s=1){super(),this.extendsPhongMaterial=!0,this.type="PhongMaterial",this.shaderType="fs_phong",this.diffuse=t,this.ambient=e,this.specular=n,this.shininess=r,this.emissive=i,this.emissiveIntensity=s}getMaterialData(t){const e=new Float32Array(16),n=this.ambient*t.ka,r=new a.Color;r.setColorFromVec3(t.ambientLightColor.getVec3Intensity(n));const i=t.kd,s=new a.Color;s.setColorFromVec3(this.diffuse.getVec3Intensity(i));const o=t.ks,h=new a.Color;h.setColorFromVec3(this.specular.getVec3Intensity(o));const u=new a.Color;return u.setColorFromVec3(this.emissive.getVec3Intensity(this.emissiveIntensity)),e[0]=r.r,e[1]=r.g,e[2]=r.b,e[3]=this.shininess,e[4]=h.r,e[5]=h.g,e[6]=h.b,e[7]=0,e[8]=s.r,e[9]=s.g,e[10]=s.b,e[11]=0,e[12]=u.r,e[13]=u.g,e[14]=u.b,e[15]=0,e}}e.PhongMaterial=i},797:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.SimpleMaterial=void 0;const a=n(524),r=n(126);class i extends r.TexturedMaterial{constructor(t=new a.Color(0,0,0)){super(),this.extendsSimpleMaterial=!0,this.type="SimpleMaterial",this.shaderType="fs_simple",this.emissive=t}getMaterialData(t){const e=new Float32Array(4);return e[0]=this.emissive.r,e[1]=this.emissive.g,e[2]=this.emissive.b,e[3]=0,e}}e.SimpleMaterial=i},126:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TexturedMaterial=void 0;const a=n(930);class r extends a.Material{constructor(){super(),this.extendsTexturedMaterial=!0,this.type="TexturedMaterial",this.mapLoaded=!1}setTexture(t){this.map=t}}e.TexturedMaterial=r},644:function(t,e,n){var a=this&&this.__awaiter||function(t,e,n,a){return new(n||(n=Promise))((function(r,i){function s(t){try{h(a.next(t))}catch(t){i(t)}}function o(t){try{h(a.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}h((a=a.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.BufferObject=void 0;const r=n(887),i=n(556);let s=0;e.BufferObject=class{constructor(t="none"){this.extendsBufferObjects=!0,this.type="BufferObject",this.stride=4,this.format3="float32x3",this.format2="float32x2",this.indexFormat="uint16",this.bufferData={position:[],itemSizePosition:3,normal:[],itemSizeNormal:3,uv:[],itemSizeUV:2},this.indexData=[],this.id=s++,this.byteLength=0,this.vertexDescriptor={size:0,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0},this.vertexBuffer=null,this.indexDescriptor={size:0,usage:GPUBufferUsage.INDEX|GPUBufferUsage.COPY_DST,mappedAtCreation:!0},this.indexBuffer=null,this.triangleDescriptor={size:0,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST,mappedAtCreation:!0},this.triangleBuffer=null,this.BlBVH=null,this.updated=!1,this.instanceCount=0,this.cullMode=t}addVertex3(t){this.bufferData.position.push(t[0]),this.bufferData.position.push(t[1]),this.bufferData.position.push(t[2]),this.updated=!0}addNormal3(t){this.bufferData.normal.push(t[0]),this.bufferData.normal.push(t[1]),this.bufferData.normal.push(t[2]),this.updated=!0}addUV2(t){this.bufferData.uv.push(t[0]),this.bufferData.uv.push(t[1]),this.updated=!0}addCustomVertex(t){for(let e=0;e<t.length;e++)this.bufferData.position.push(t[e]);this.updated=!0}addCustomNormal(t){for(let e=0;e<t.length;e++)this.bufferData.normal.push(t[e]);this.updated=!0}addCustomUV(t){for(let e=0;e<t.length;e++)this.bufferData.uv.push(t[e]);this.updated=!0}addIndex(t){for(let e=0;e<t.length;e++)this.indexData.push(t[e])}setByteLength(t,e){const n=this.stride*this.instanceCount*3,a=t*n;this.byteLength=a,this.vertexDescriptor.size=a,this.triangleDescriptor.size=e*n,this.indexDescriptor.size=2*this.indexData.length,this.indexDescriptor.size+=this.indexDescriptor.size%4}setVertexLayout(){let t=0,e=0,n=0;const a=[];if(a.push({shaderLocation:n,format:this.format3,offset:0}),t+=3,e++,n++,a.push({shaderLocation:n,format:this.format3,offset:t*this.stride}),t+=3,e++,n++,0==this.bufferData.normal.length)for(let t=0;t<this.bufferData.position.length;t+=9){const e=r.vec3.fromValues(this.bufferData.position[t],this.bufferData.position[t+1],this.bufferData.position[t+2]),n=r.vec3.fromValues(this.bufferData.position[t+3],this.bufferData.position[t+4],this.bufferData.position[t+5]),a=r.vec3.fromValues(this.bufferData.position[t+6],this.bufferData.position[t+7],this.bufferData.position[t+8]),i=r.vec3.create();r.vec3.cross(i,r.vec3.sub(r.vec3.create(),n,e),r.vec3.sub(r.vec3.create(),a,e)),r.vec3.normalize(i,i),this.addNormal3(i),this.addNormal3(i),this.addNormal3(i)}a.push({shaderLocation:n,format:this.format2,offset:t*this.stride}),t+=2,e+=2,this.vertexLayout={arrayStride:t*this.stride,attributes:a},this.setByteLength(t,4)}updateData(){0==this.indexDescriptor.size?this.instanceCount=this.bufferData.position.length/9:this.instanceCount=this.indexData.length/3,this.setVertexLayout()}updateVertexData(t,e=!1){if(this.updated||e){const e=this.byteLength,n=this.indexDescriptor.size;this.updateData(),null!=this.vertexBuffer&&this.byteLength==e||(this.vertexBuffer=t.createBuffer(this.vertexDescriptor),null!=this.triangleBuffer&&(this.triangleBuffer.destroy(),this.triangleBuffer=null,this.BlBVH=null)),(null==this.indexBuffer||this.indexDescriptor.size!=n&&this.indexDescriptor.size>0)&&(this.indexBuffer=t.createBuffer(this.indexDescriptor));const a=new ArrayBuffer(this.vertexDescriptor.size),r=new Float32Array(a);if(this.indexDescriptor.size>0){const t=new ArrayBuffer(this.indexDescriptor.size),e=new Uint16Array(t);this.fillBuffer(r,e),new Uint16Array(this.indexBuffer.getMappedRange()).set(e),this.indexBuffer.unmap()}else this.fillBuffer(r,null);new Float32Array(this.vertexBuffer.getMappedRange()).set(r),this.vertexBuffer.unmap(),this.updated=!1}}fillBuffer(t,e){let n=0;for(let e=0;e<3*this.instanceCount;e++)t[n]=this.bufferData.position[3*e],t[n+1]=this.bufferData.position[3*e+1],t[n+2]=this.bufferData.position[3*e+2],t[n+3]=this.bufferData.normal[3*e],t[n+4]=this.bufferData.normal[3*e+1],t[n+5]=this.bufferData.normal[3*e+2],this.bufferData.uv.length>0?(t[n+6]=this.bufferData.uv[2*e],t[n+7]=this.bufferData.uv[2*e+1]):(t[n+6]=0,t[n+7]=0),n+=8;null!=e&&e.set(this.indexData,0)}updateTriangleData(t,e=!1){if(this.updated||e){const e=this.triangleDescriptor.size;this.updateData(),null!=this.triangleBuffer&&this.triangleDescriptor.size==e||(this.triangleBuffer=t.createBuffer(this.triangleDescriptor),null!=this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBuffer=null),null!=this.indexBuffer&&(this.indexBuffer.destroy(),this.indexBuffer=null));const n=new ArrayBuffer(this.triangleDescriptor.size),a=new Float32Array(n);this.fillTriangleBuffer(a),this.BlBVH=new i.BlBVH(a),new Float32Array(this.triangleBuffer.getMappedRange()).set(a),this.triangleBuffer.unmap(),this.updated=!1}}fillTriangleBuffer(t){const e=this.indexDescriptor.size>0?t=>this.indexData[t]:t=>t;for(let n=0;n<this.instanceCount;n++)for(let a=0;a<3;a++){const r=e(3*n+a),i=3*r,s=2*r;t[36*n+12*a]=this.bufferData.position[i],t[36*n+12*a+1]=this.bufferData.position[i+1],t[36*n+12*a+2]=this.bufferData.position[i+2],t[36*n+12*a+3]=0,t[36*n+12*a+4]=this.bufferData.normal[i],t[36*n+12*a+5]=this.bufferData.normal[i+1],t[36*n+12*a+6]=this.bufferData.normal[i+2],t[36*n+12*a+7]=0,t[36*n+12*a+8]=this.bufferData.uv[s],t[36*n+12*a+9]=this.bufferData.uv[s+1],t[36*n+12*a+10]=0,t[36*n+12*a+11]=0}}applyMatrixVertex(t){for(let e=0;e<this.bufferData.position.length;e+=this.bufferData.itemSizePosition){const n=r.vec3.fromValues(this.bufferData.position[e],this.bufferData.position[e+1],this.bufferData.position[e+2]);r.vec3.transformMat4(n,n,t),this.bufferData.position[e]=n[0],this.bufferData.position[e+1]=n[1],this.bufferData.position[e+2]=n[2]}}applyMatrixNormal(t){for(let e=0;e<this.bufferData.normal.length;e+=this.bufferData.itemSizeNormal){const n=r.vec3.fromValues(this.bufferData.normal[e],this.bufferData.normal[e+1],this.bufferData.normal[e+2]);r.vec3.transformMat4(n,n,t),this.bufferData.normal[e]=n[0],this.bufferData.normal[e+1]=n[1],this.bufferData.normal[e+2]=n[2]}}applyMatrix(t){this.applyMatrixVertex(t),this.applyMatrixNormal(t)}rotateX(t){const e=r.mat4.create();r.mat4.rotateX(e,e,t),this.applyMatrix(e)}rotateY(t){const e=r.mat4.create();r.mat4.rotateY(e,e,t),this.applyMatrix(e)}rotateZ(t){const e=r.mat4.create();r.mat4.rotateZ(e,e,t),this.applyMatrix(e)}rotateXYZ(t){const e=r.mat4.create();r.mat4.rotateX(e,e,t[0]),r.mat4.rotateY(e,e,t[1]),r.mat4.rotateZ(e,e,t[2]),this.applyMatrix(e)}translateX(t){const e=r.mat4.create();r.mat4.translate(e,e,r.vec3.fromValues(t,0,0)),this.applyMatrix(e)}translateY(t){const e=r.mat4.create();r.mat4.translate(e,e,r.vec3.fromValues(0,t,0)),this.applyMatrix(e)}translateZ(t){const e=r.mat4.create();r.mat4.translate(e,e,r.vec3.fromValues(0,0,t)),this.applyMatrix(e)}translateXYZ(t){const e=r.mat4.create();r.mat4.translate(e,e,t),this.applyMatrix(e)}scaleXYZ(t){const e=r.mat4.create();r.mat4.scale(e,e,t),this.applyMatrix(e)}lookAt(t){const e=r.mat4.create();r.mat4.lookAt(e,r.vec3.fromValues(0,0,0),t,r.vec3.fromValues(0,1,0)),this.applyMatrix(e)}loadObj(t){return a(this,void 0,void 0,(function*(){this.bufferData.position=[],this.bufferData.normal=[],this.bufferData.uv=[],this.indexData=[],yield this.loadObjData(t)}))}loadObjData(t){return a(this,void 0,void 0,(function*(){const e=yield fetch(t),n=yield e.blob(),a=(yield n.text()).split("\n"),r=[],i=[],s=[];a.forEach((t=>{"v"==t[0]&&" "==t[1]?this.readObjVertex(t,r):"v"==t[0]&&"t"==t[1]?this.readObjUv(t,i):"v"==t[0]&&"n"==t[1]?this.readObjNormal(t,s):"f"==t[0]&&this.readObjFace(t,r,i,s)}))}))}readObjVertex(t,e){const n=t.split(" "),a=r.vec3.fromValues(parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]));e.push(a)}readObjUv(t,e){const n=t.split(" "),a=r.vec2.fromValues(parseFloat(n[1]),parseFloat(n[2]));e.push(a)}readObjNormal(t,e){const n=t.split(" "),a=r.vec3.fromValues(parseFloat(n[1]),parseFloat(n[2]),parseFloat(n[3]));e.push(a)}readObjFace(t,e,n,a){const r=(t=t.replace("\n","")).split(" "),i=r.length-3;for(let t=0;t<i;t++)this.read_corner(r[1],e,n,a),this.read_corner(r[2+t],e,n,a),this.read_corner(r[3+t],e,n,a)}read_corner(t,e,n,a){const r=t.split("/"),i=parseInt(r[0])-1,s=parseInt(r[1])-1,o=parseInt(r[2])-1,h=e[i],u=n[s],l=a[o];this.addVertex3(h),this.addUV2(u),this.addNormal3(l)}}},831:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Group=void 0;const a=n(262);class r extends a.ParentObject{constructor(){super(),this.extendsGroup=!0,this.type="Group"}}e.Group=r},460:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MainObject=void 0;const a=n(887);e.MainObject=class{constructor(){this.extendsMainObject=!0,this.type="MainObject",this.parent=null,this.position=a.vec3.create(),this.scale=[1,1,1],this.rotation=a.vec3.create(),this.up=[0,1,0],this.model=a.mat4.create(),this.transformed=!0}rotateX(t){this.rotation[0]+=t,this.rotation[0]%=2*Math.PI,this.transformed=!0}rotateY(t){this.rotation[1]+=t,this.rotation[1]%=2*Math.PI,this.transformed=!0}rotateZ(t){this.rotation[2]+=t,this.rotation[2]%=2*Math.PI,this.transformed=!0}rotateXYZ(t){this.rotation[0]+=t[0],this.rotation[1]+=t[1],this.rotation[2]+=t[2],this.rotation[0]%=2*Math.PI,this.rotation[1]%=2*Math.PI,this.rotation[2]%=2*Math.PI,this.transformed=!0}translateX(t){this.position[0]+=t,this.transformed=!0}translateY(t){this.position[1]+=t,this.transformed=!0}translateZ(t){this.position[2]+=t,this.transformed=!0}translateXYZ(t){this.position[0]+=t[0],this.position[1]+=t[1],this.position[2]+=t[2],this.transformed=!0}scaleX(t){this.scale[0]*=t,this.transformed=!0}scaleY(t){this.scale[1]*=t,this.transformed=!0}scaleZ(t){this.scale[2]*=t,this.transformed=!0}scaleXYZ(t){this.scale[0]*=t[0],this.scale[1]*=t[1],this.scale[2]*=t[2],this.transformed=!0}lookAt(t){this.extendsCamera?(a.mat4.lookAt(this.model,this.position,t,this.up),this.target=t):a.mat4.lookAt(this.model,t,this.position,this.up),this.transformed=!0}applyMatrix(t){a.mat4.mul(this.model,this.model,t),this.transformed=!0}updateModel(){this.transformed&&(this.model=a.mat4.create(),a.mat4.translate(this.model,this.model,this.position),a.mat4.rotateX(this.model,this.model,this.rotation[0]),a.mat4.rotateY(this.model,this.model,this.rotation[1]),a.mat4.rotateZ(this.model,this.model,this.rotation[2]),a.mat4.scale(this.model,this.model,this.scale)),this.parent&&this.parent.transformed&&a.mat4.mul(this.model,this.parent.model,this.model)}updateVectorsFromModel(){(this.parent&&this.parent.transformed||this.transformed)&&(a.mat4.getTranslation(this.position,this.model),a.mat4.getScaling(this.scale,this.model))}removeParent(){this.parent&&this.parent.removeChild(this)}fillModelBuffers(t,e,n){return(this.parent&&this.parent.transformed||this.transformed)&&(n?t.set(a.mat4.invert(a.mat4.create(),this.model),e):t.set(this.model,e),this.transformed=!1),16}}},699:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Mesh=void 0;const a=n(460),r=n(644);class i extends a.MainObject{constructor(t=new r.BufferObject,e){super(),this.extendsMesh=!0,this.type="Mesh",this.geometry=t,this.material=e}update(){this.updateModel(),this.updateVectorsFromModel()}}e.Mesh=i},262:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ParentObject=e.totalMeshCount=void 0;const a=n(460);e.totalMeshCount=0;class r extends a.MainObject{constructor(){super(),this.extendsParentObject=!0,this.type="ParentObject",this.children=[],this.meshCount=0}update(){this.transformed&&(this.updateModel(),this.updateVectorsFromModel()),this.children.forEach((t=>{t.update()}))}addChild(t){t.parent&&t.parent.removeChild(t),t.parent=this,this.children.push(t),t.extendsMesh&&(this.meshCount++,e.totalMeshCount++)}removeChild(t){t.parent=null,this.children.splice(this.children.indexOf(t),1),this.meshCount--,e.totalMeshCount--}fillModelBuffers(t,e,n=!1){let a=0;return this.children.forEach((r=>{const i=r.fillModelBuffers(t,e,n);e+=i,a+=i})),this.transformed=!1,a}}e.ParentObject=r},780:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.PlaneBasedObject=void 0;const a=n(644),r=n(887);class i extends a.BufferObject{constructor(){super(),this.extendsPlaneBasedObject=!0,this.type="PlaneBasedObject"}buildPlane(t,e,n,a,i,s,o,h,u,l,f){const c=s/u,d=o/l,m=s/2,p=o/2,v=h/2;for(let s=0;s<=l;s++){const o=i*(s*d-p);for(let i=0;i<=u;i++){const f=a*(i*c-m),d=v,p=r.vec3.create();p[t]=f,p[e]=o,p[n]=d,this.addVertex3(p);const M=r.vec3.create();M[t]=0,M[e]=0,M[n]=+(h>=0)-+(h<0),this.addNormal3(M),this.addUV2([i/u,1-s/l])}}for(let t=0;t<l;t++){const e=t+1;for(let n=0;n<u;n++){const a=u+1,r=n+f,i=r+1,s=e*a,o=t*a,h=r+o,l=r+s,c=i+s,d=i+o;this.addIndex([h,l,d,l,c,d])}}}}e.PlaneBasedObject=i},632:function(t,e,n){var a=this&&this.__awaiter||function(t,e,n,a){return new(n||(n=Promise))((function(r,i){function s(t){try{h(a.next(t))}catch(t){i(t)}}function o(t){try{h(a.throw(t))}catch(t){i(t)}}function h(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,o)}h((a=a.apply(t,e||[])).next())}))},r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.WebGPURenderer=void 0;const i=r(n(495)),s=r(n(523)),o=r(n(313)),h=r(n(420)),u=r(n(858)),l=r(n(96)),f=n(887),c=n(524);e.WebGPURenderer=class{constructor(t,e=!0,n=!0,a=!1,r=new c.Color(.7,.7,.7)){if(this.extendsWebGPURenderer=!0,this.type="WebGPURenderer",this.sampleCount=4,this.pipelines={},this.vertShaderModules={},this.fragShaderModules={},this.materialBindGroups={},void 0===navigator.gpu)throw"WebGPU not supported";this.canvas=t,this.useDepthBuffer=e,this.useAntialiasing=n,this.useAlphaPremultiplied=a,this.backgroundColor=r,this.modelBuffer=new Float32Array(65536),this.lightSourceBuffer=new Float32Array(10240)}Initialize(){return a(this,void 0,void 0,(function*(){yield this.setupDevice(),yield this.makeBindGroupLayouts(),yield this.createAssets(),this.useDepthBuffer&&(yield this.makeDepthBufferResources()),yield this.makePipelineData(),yield this.makeBindGroups()}))}setupDevice(){var t,e;return a(this,void 0,void 0,(function*(){this.adapter=yield null===(t=navigator.gpu)||void 0===t?void 0:t.requestAdapter(),this.device=yield null===(e=this.adapter)||void 0===e?void 0:e.requestDevice(),this.context=this.canvas.getContext("webgpu"),this.format="bgra8unorm",this.context.configure({device:this.device,format:this.format,alphaMode:this.useAlphaPremultiplied?"premultiplied":"opaque"})}))}createAssets(){return a(this,void 0,void 0,(function*(){this.cameraUniformBuffer=this.device.createBuffer({size:64,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST}),this.objectModelBuffer=this.device.createBuffer({size:262144,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.lightBuffer=this.device.createBuffer({size:40976,usage:GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_DST}),this.wsCameraPositionUniformBuffer=this.device.createBuffer({size:16,usage:GPUBufferUsage.UNIFORM|GPUBufferUsage.COPY_DST})}))}makeDepthBufferResources(){return a(this,void 0,void 0,(function*(){this.depthStencilState={depthWriteEnabled:!0,depthCompare:"less-equal",format:"depth24plus-stencil8"};const t={size:{width:this.canvas.width,height:this.canvas.height,depthOrArrayLayers:1},format:this.depthStencilState.format,usage:GPUTextureUsage.RENDER_ATTACHMENT,sampleCount:this.useAntialiasing?this.sampleCount:1};this.depthStencilBuffer=this.device.createTexture(t);const e={format:this.depthStencilState.format,dimension:"2d",aspect:"all"};this.depthStencilView=this.depthStencilBuffer.createView(e),this.depthStencilAttachment={view:this.depthStencilView,depthClearValue:1,depthLoadOp:"clear",depthStoreOp:"store",stencilLoadOp:"clear",stencilStoreOp:"discard"}}))}makeBindGroupLayouts(){return a(this,void 0,void 0,(function*(){this.frameGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.VERTEX,buffer:{type:"uniform"}},{binding:1,visibility:GPUShaderStage.VERTEX,buffer:{type:"read-only-storage",hasDynamicOffset:!1}}]}),this.lightGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"read-only-storage",hasDynamicOffset:!1}},{binding:1,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}]}),this.materialGroupLayout=this.device.createBindGroupLayout({entries:[{binding:0,visibility:GPUShaderStage.FRAGMENT,buffer:{type:"uniform"}}]})}))}makePipelineData(){return a(this,void 0,void 0,(function*(){this.bindGroupLayouts=[this.frameGroupLayout,this.lightGroupLayout];const t=[l.default],e=["vs_main"],n=[i.default,s.default,o.default,h.default,u.default],a=["fs_phong","fs_phong_texture","fs_normal","fs_simple","fs_simple_texture"];for(let n=0;n<t.length;n++)this.vertShaderModules[e[n]]=this.device.createShaderModule({code:t[n]});for(let t=0;t<n.length;t++)this.fragShaderModules[a[t]]=this.device.createShaderModule({code:n[t]})}))}makeBindGroups(){return a(this,void 0,void 0,(function*(){this.frameBindGroup=this.device.createBindGroup({layout:this.frameGroupLayout,entries:[{binding:0,resource:{buffer:this.cameraUniformBuffer}},{binding:1,resource:{buffer:this.objectModelBuffer}}]}),this.lightBindGroup=this.device.createBindGroup({layout:this.lightGroupLayout,entries:[{binding:0,resource:{buffer:this.lightBuffer}},{binding:1,resource:{buffer:this.wsCameraPositionUniformBuffer}}]})}))}makePipeline(t,e,n,a){const r=this.device.createPipelineLayout({bindGroupLayouts:a}),i={module:this.vertShaderModules.vs_main,entryPoint:"vs_main",buffers:[t]},s={module:this.fragShaderModules[n.shaderType],entryPoint:n.shaderType,targets:[{format:this.format}]};return this.device.createRenderPipeline({layout:r,depthStencil:this.useDepthBuffer?this.depthStencilState:void 0,multisample:this.useAntialiasing?{count:this.sampleCount}:void 0,vertex:i,fragment:s,primitive:{topology:"triangle-list",cullMode:e}})}makeMaterialBindGroup(t,e){const n=t.getMaterialData(e),a=this.device.createBuffer({size:n.byteLength,usage:GPUBufferUsage.UNIFORM,mappedAtCreation:!0});return new Float32Array(a.getMappedRange()).set(n),a.unmap(),this.device.createBindGroup({layout:this.materialGroupLayout,entries:[{binding:0,resource:{buffer:a}}]})}renderMesh(t,e,n,a){var r;const i=t.material;if(!i.visible)return n;const s=t.geometry;s.updateVertexData(this.device);const o=s.vertexBuffer,h=s.indexBuffer;let u,l;const f=s.id,c=void 0!==this.pipelines[f],d=void 0!==this.materialBindGroups[i.shaderType],m=[...this.bindGroupLayouts];if(i.extendsNormalMaterial||(d||(this.materialBindGroups[i.shaderType]=this.makeMaterialBindGroup(i,a)),c||m.push(this.materialGroupLayout),u=this.materialBindGroups[i.shaderType],e.setBindGroup(2,u)),i.extendsTexturedMaterial&&(null===(r=i.map)||void 0===r?void 0:r.initialized)){const t=i;t.mapLoaded||(t.mapLoaded=!0,t.shaderType+="_texture"),c||m.push(t.map.textureGroupLayout),e.setBindGroup(3,t.map.textureBindGroup)}return c?l=this.pipelines[f]:(l=this.makePipeline(s.vertexLayout,s.cullMode,i,m),this.pipelines[f]=l),e.setPipeline(l),e.setVertexBuffer(0,o),s.indexData.length>0?(e.setIndexBuffer(h,s.indexFormat),e.drawIndexed(s.indexData.length,1,0,0,n)):e.draw(3*s.instanceCount,1,0,n),1}renderParentObject(t,e,n,a){let r=0;return t.children.forEach((t=>{t.extendsParentObject?r+=this.renderParentObject(t,e,n+r,a):t.extendsMesh&&(r+=this.renderMesh(t,e,n+r,a))})),r}render(t){t.update(),t.camera.update();const e=t.camera.projectionMatrix,n=t.camera.model,a=f.mat4.create();f.mat4.multiply(a,e,n),this.device.queue.writeBuffer(this.cameraUniformBuffer,0,a);const r=t.fillModelBuffers(this.modelBuffer,0);this.device.queue.writeBuffer(this.objectModelBuffer,0,this.modelBuffer,0,r);const i=t.camera.getWorldPosition();this.device.queue.writeBuffer(this.wsCameraPositionUniformBuffer,0,i),t.fillLightBuffer(this.lightSourceBuffer);const s=new Uint32Array(4);s[0]=t.lights.length,this.device.queue.writeBuffer(this.lightBuffer,0,s),this.device.queue.writeBuffer(this.lightBuffer,16,this.lightSourceBuffer);const o=t.getGlobalParameters(),h=this.context.getCurrentTexture().createView();let u;this.useAntialiasing&&(u=this.device.createTexture({size:[this.canvas.width,this.canvas.height,1],sampleCount:this.sampleCount,format:this.format,usage:GPUTextureUsage.RENDER_ATTACHMENT}));const l={view:this.useAntialiasing?u.createView():h,resolveTarget:this.useAntialiasing?h:void 0,clearValue:{r:this.backgroundColor.r,g:this.backgroundColor.g,b:this.backgroundColor.b,a:1},loadOp:"clear",storeOp:"store"},c=this.device.createCommandEncoder(),d=c.beginRenderPass({colorAttachments:[l],depthStencilAttachment:this.useDepthBuffer?this.depthStencilAttachment:void 0});d.setBindGroup(0,this.frameBindGroup),d.setBindGroup(1,this.lightBindGroup),this.renderParentObject(t,d,0,o),d.end(),this.device.queue.submit([c.finish()])}getDevice(){return this.device}}},556:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.TlBVH=e.BlBVH=e.BlDescription=void 0;const a=n(392),r=n(887),i=n(674);e.BlDescription=class{constructor(t,e,n){this.minCorner=[999999,999999,999999],this.maxCorner=[-999999,-999999,-999999],this.inverseModel=r.mat4.create(),this.center=r.vec3.create();const a=r.vec3.create(),i=[[t[0],t[1],t[2]],[t[0],t[1],e[2]],[t[0],e[1],t[2]],[t[0],e[1],e[2]],[e[0],t[1],t[2]],[e[0],t[1],e[2]],[e[0],e[1],t[2]],[e[0],e[1],e[2]]];for(let t=0;t<i.length;t++)r.vec3.transformMat4(a,i[t],n),r.vec3.min(this.minCorner,this.minCorner,a),r.vec3.max(this.maxCorner,this.maxCorner,a);r.vec3.add(this.center,this.minCorner,this.maxCorner),r.vec3.scale(this.center,this.center,.5),r.mat4.invert(this.inverseModel,n)}},e.BlBVH=class{constructor(t){this.triangleCount=t.length/36,this.triangleIndices=new Array(this.triangleCount),this.centroids=new Array(this.triangleCount),this.corners=new Array(3*this.triangleCount),this.nodes=new Array(2*this.triangleCount-1),this.nodeCount=0,this.minCorner=r.vec3.fromValues(999999,999999,999999),this.maxCorner=r.vec3.fromValues(-999999,-999999,-999999),this.makeCentroids(t),this.build()}makeCentroids(t){for(let e=0;e<t.length;e+=36){const n=e/36;let a=r.vec3.create();const i=r.vec3.fromValues(t[e],t[e+1],t[e+2]),s=r.vec3.fromValues(t[e+12],t[e+13],t[e+14]),o=r.vec3.fromValues(t[e+24],t[e+25],t[e+26]);a[0]=(i[0]+s[0]+o[0])/3,a[1]=(i[1]+s[1]+o[1])/3,a[2]=(i[2]+s[2]+o[2])/3,this.centroids[n]=a,r.vec3.min(this.minCorner,this.minCorner,i),r.vec3.min(this.minCorner,this.minCorner,s),r.vec3.min(this.minCorner,this.minCorner,o),r.vec3.max(this.maxCorner,this.maxCorner,i),r.vec3.max(this.maxCorner,this.maxCorner,s),r.vec3.max(this.maxCorner,this.maxCorner,o),this.corners[3*n]=i,this.corners[3*n+1]=s,this.corners[3*n+2]=o}}build(){for(let t=0;t<this.triangleCount;t++)this.triangleIndices[t]=t,this.nodes[t]=new a.Node;for(let t=this.triangleCount;t<this.nodes.length;t++)this.nodes[t]=new a.Node;this.nodes[0].primitiveCount=this.triangleCount,this.nodeCount++,this.updateBounds(0),this.divide(0)}updateBounds(t){const e=this.nodes[t];for(let t=0;t<e.primitiveCount;t++){const n=this.triangleIndices[e.leftChild+t];for(let t=0;t<3;t++)r.vec3.min(e.minCorner,e.minCorner,this.corners[3*n+t]),r.vec3.max(e.maxCorner,e.maxCorner,this.corners[3*n+t])}}SAH(t,e,n){const a=this.nodes[t],r=new i.AABB,s=new i.AABB;let o=0,h=0;for(let t=0;t<a.primitiveCount;t++){const i=this.triangleIndices[a.leftChild+t];if(this.centroids[i][e]<n){o++;for(let t=0;t<3;t++)r.grow(this.corners[3*i+t])}else{h++;for(let t=0;t<3;t++)s.grow(this.corners[3*i+t])}}const u=r.area()*o+s.area()*h;return u<a.primitiveCount?u:999999}divide(t){const e=this.nodes[t];if(e.primitiveCount<=4)return;const n=r.vec3.create();r.vec3.subtract(n,e.maxCorner,e.minCorner);let a=0,i=0,s=999999;for(let n=0;n<3;n++){const r=e.minCorner[n],o=e.maxCorner[n];if(r==o)continue;const h=16,u=(o-r)/h,l=new Array(h);for(let o=0;o<e.primitiveCount;o++){const f=this.triangleIndices[e.leftChild+o],c=this.centroids[f],d=Math.min(Math.floor((c[n]-r)/u),h-1);l[d].primitiveCount++,l[d].bounds.grow(this.corners[3*f]),l[d].bounds.grow(this.corners[3*f+1]),l[d].bounds.grow(this.corners[3*f+2]);const m=r+o/u,p=this.SAH(t,n,m);p<s&&(a=n,i=m,s=p)}}const o=r.vec3.create();if(r.vec3.subtract(o,e.maxCorner,e.minCorner),s>=(o[0]*o[1]+o[0]*o[2]+o[1]*o[2])*e.primitiveCount)return;let h=a,u=i,l=e.leftChild,f=e.leftChild+e.primitiveCount-1;for(;l<=f;)if(this.centroids[this.triangleIndices[l]][h]<u)l++;else{const t=this.triangleIndices[l];this.triangleIndices[l]=this.triangleIndices[f],this.triangleIndices[f]=t,f--}const c=l-e.leftChild;if(0==c||c==e.primitiveCount)return;const d=this.nodeCount,m=this.nodeCount+1;this.nodeCount+=2,this.nodes[d].leftChild=e.leftChild,this.nodes[d].primitiveCount=c,this.nodes[m].leftChild=l,this.nodes[m].primitiveCount=e.primitiveCount-c,e.leftChild=d,e.primitiveCount=0,this.updateBounds(d),this.updateBounds(m),this.divide(d),this.divide(m)}},e.TlBVH=class{constructor(){this.maxNodes=0,this.nodes=[],this.nodeCount=0,this.blConsumed=!1,this.blDescriptions=[],this.blIndices=[]}build(){}}},498:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Scene=void 0;const a=n(262),r=n(594),i=n(524);class s extends a.ParentObject{constructor(t=new r.FrustumViewCamera,e=1,n=1,a=1){super(),this.extendsScene=!0,this.type="Scene",this.ambientLights=[],this.ambientLightColor=new i.Color(0,0,0),this.lights=[],this.camera=t,this.ka=e,this.kd=n,this.ks=a}addChild(t){t.extendsLight?"AmbientLight"==t.type?this.addAmbientLight(t):this.lights.push(t):super.addChild(t)}addAmbientLight(t){this.ambientLights.push(t),this.ambientLightColor.addColor(t.color,t.intensity)}getGlobalParameters(){return{ka:this.ka,ambientLightColor:this.ambientLightColor,kd:this.kd,ks:this.ks}}fillLightBuffer(t){let e=0;this.lights.forEach((n=>{if(n.transformed){const a=n.getLightData();this.fillLightData(t,e,a),this.transformed=!1}e+=20}))}fillLightData(t,e,n){t[e]=n.dir[0],t[e+1]=n.dir[1],t[e+2]=n.dir[2],t[e+3]=n.sourceType,t[e+4]=n.color[0],t[e+5]=n.color[1],t[e+6]=n.color[2],t[e+7]=n.angle,t[e+8]=n.pos[0],t[e+9]=n.pos[1],t[e+10]=n.pos[2],t[e+11]=n.penumbra,t[e+12]=n.falloffFunc[0],t[e+13]=n.falloffFunc[1],t[e+14]=n.falloffFunc[2],t[e+15]=n.falloffType,t[e+16]=n.range,t[e+17]=0,t[e+18]=0,t[e+19]=0}}e.Scene=s},674:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Bin=e.AABB=void 0;const a=n(887);class r{constructor(){this.bmin=[1e30,1e30,1e30],this.bmax=[-1e30,-1e30,-1e30]}grow(t){a.vec3.min(this.bmin,this.bmin,t),a.vec3.max(this.bmax,this.bmax,t)}area(){const t=a.vec3.create();return a.vec3.sub(t,this.bmax,this.bmin),t[0]*t[1]+t[1]*t[2]+t[2]*t[0]}}e.AABB=r,e.Bin=class{constructor(){this.bounds=new r,this.primitiveCount=0}}},629:(t,e)=>{var n;Object.defineProperty(e,"__esModule",{value:!0}),e.AttenuationType=void 0,(n=e.AttenuationType||(e.AttenuationType={}))[n.None=-1]="None",n[n.Constant=0]="Constant",n[n.Linear=1]="Linear",n[n.Quadratic=2]="Quadratic"},524:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Color=void 0,e.Color=class{constructor(t=1,e=1,n=1){this.extendsColor=!0,this.type="Color",this.r=t,this.g=e,this.b=n}setColor(t,e,n){this.r=t,this.g=e,this.b=n}setColorFromVec3(t){this.r=t[0],this.g=t[1],this.b=t[2]}addColor(t,e){this.r+=t.r*e,this.g+=t.g*e,this.b+=t.b*e}getVec3(){return[this.r,this.g,this.b]}getVec3Intensity(t){return[this.r*t,this.g*t,this.b*t]}}},392:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Node=void 0,e.Node=class{}},313:(t,e,n)=>{n.r(e),n.d(e,{default:()=>a});const a="\nstruct lightSource {\n    dir : vec3<f32>,\n    sourceType : f32,\n    color : vec3<f32>,\n    angle : f32,\n    pos : vec3<f32>,\n    penumbra : f32,\n    falloffFunc : vec3<f32>,\n    falloffType : f32,\n    range : f32\n}\n\nstruct lightData {\n    lightCount : i32,\n    lightSources : array<lightSource>\n}\n\n@binding(0) @group(1) var<storage, read> lightDataBuffer : lightData;\n@binding(1) @group(1) var<uniform> wsCamera : vec3<f32>;\n\n@fragment\nfn fs_normal(@location(0) wsPosition : vec4<f32>, @location(1) wsNormal : vec4<f32>,\n    @location(2) texCoord : vec2<f32>) -> @location(0) vec4<f32> {\n\n    let normal : vec3<f32> = vec3<f32>(wsNormal.x, wsNormal.y, wsNormal.z);\n    var normal4 : vec4<f32> = vec4<f32>(normalize(normal) * 0.5 + 0.5, 1.0);\n\n    return normal4;\n}"},495:(t,e,n)=>{n.r(e),n.d(e,{default:()=>a});const a="\nstruct lightSource {\n    dir : vec3<f32>,\n    sourceType : f32,\n    color : vec3<f32>,\n    angle : f32,\n    pos : vec3<f32>,\n    penumbra : f32,\n    falloffFunc : vec3<f32>,\n    falloffType : f32,\n    range : f32\n}\n\nstruct lightData {\n    lightCount : i32,\n    lightSources : array<lightSource>\n}\n\nstruct materialData {\n    ka : vec3<f32>,\n    shininess : f32,\n    ks : vec3<f32>,\n    kd : vec3<f32>,\n    emissive : vec3<f32>,\n}\n\n@binding(0) @group(1) var<storage, read> lightDataBuffer : lightData;\n@binding(1) @group(1) var<uniform> wsCamera : vec3<f32>;\n@binding(0) @group(2) var<uniform> material : materialData;\n\n@fragment\nfn fs_phong(@location(0) wsPosition : vec4<f32>, @location(1) wsNormal : vec4<f32>,\n    @location(2) texCoord : vec2<f32>) -> @location(0) vec4<f32> {\n\n    // 1 is directional light, 2 is point light, 3 is spot light\n\n    let normal : vec3<f32> = normalize(vec3<f32>(wsNormal.x, wsNormal.y, wsNormal.z));\n    let position : vec3<f32> = vec3<f32>(wsPosition.x, wsPosition.y, wsPosition.z);\n\n    var fragColor : vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 1.0);\n    fragColor += vec4<f32>(material.ka.r, material.ka.g, material.ka.b, 0.0);\n    fragColor += vec4<f32>(material.emissive.r, material.emissive.g, material.emissive.b, 0.0);\n    var fragAcc : vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 0.0);\n\n    for (var i = 0; i < lightDataBuffer.lightCount; i++) {\n        let light : lightSource = lightDataBuffer.lightSources[i];\n\n        if (light.sourceType == 1) {\n            let dirToLight : vec3<f32> = normalize(-light.dir);\n            let diff : vec3<f32> = material.kd * clamp(dot(normal, dirToLight), 0.0, 1.0);\n\n            let reflectedLight : vec3<f32> = normalize(reflect(-dirToLight, normal));\n            let dirToCam : vec3<f32> = normalize(wsCamera - position);\n            var spec : vec3<f32>;\n            if (material.shininess == 0) {\n                spec = material.ks;\n            }\n            else {\n                spec = material.ks * pow(clamp(dot(reflectedLight, dirToCam), 0.0, 1.0), material.shininess);\n            }\n\n            fragAcc = vec4<f32>(clamp(light.color * (diff + spec),\n                vec3<f32>(0.0, 0.0, 0.0), vec3<f32>(1.0, 1.0, 1.0)), 0);\n        }\n\n        else if (light.sourceType == 2) {\n            let distance : f32 = distance(light.pos, position);\n            if (distance > light.range) {\n                continue;\n            }\n\n            let dirToLight : vec3<f32> = normalize(light.pos - position);\n            let diff : vec3<f32> = material.kd * clamp(dot(normal, dirToLight), 0.0, 1.0);\n\n            let fatt : f32 = calculateFatt(light.falloffType, light.falloffFunc, distance);\n\n            let reflectedLight : vec3<f32> = normalize(reflect(-dirToLight, normal));\n            let dirToCam : vec3<f32> = normalize(wsCamera - position);\n            var spec : vec3<f32>;\n            if (material.shininess == 0) {\n                spec = material.ks;\n            }\n            else {\n                spec = material.ks * pow(clamp(dot(reflectedLight, dirToCam), 0.0, 1.0), material.shininess);\n            }\n\n            fragAcc = fatt * vec4<f32>(clamp(light.color * (diff + spec),\n                vec3<f32>(0.0, 0.0, 0.0), vec3<f32>(1.0, 1.0, 1.0)), 0);\n        }\n\n        else if (light.sourceType == 3) {\n            let distance : f32 = distance(light.pos, position);\n            if (distance > light.range) {\n                continue;\n            }\n\n            let dirToLight : vec3<f32> = normalize(light.pos - position);\n            let diff : vec3<f32> = material.kd * clamp(dot(normal, dirToLight), 0.0, 1.0);\n\n            let fatt : f32 = calculateFatt(light.falloffType, light.falloffFunc, distance);\n\n            let reflectedLight : vec3<f32> = normalize(reflect(-dirToLight, normal));\n            let dirToCam : vec3<f32> = normalize(wsCamera - position);\n            var spec : vec3<f32>;\n            if (material.shininess == 0) {\n                spec = material.ks;\n            }\n            else {\n                spec = material.ks * pow(clamp(dot(reflectedLight, dirToCam), 0.0, 1.0), material.shininess);\n            }\n\n            let lightDir : vec3<f32> = normalize(light.dir);\n\n            var angleX : f32 = max(0, dot(lightDir, -dirToLight));\n            angleX = acos(angleX);\n            let thetaOuter : f32 = light.angle;\n            let thetaInner : f32 = (light.angle - light.penumbra);\n\n            if (angleX <= thetaOuter) {\n                let fc : vec4<f32> = fatt * vec4<f32>(clamp(light.color * (diff + spec),\n                    vec3<f32>(0.0, 0.0, 0.0), vec3<f32>(1.0, 1.0, 1.0)), 0);\n\n                if (angleX <= thetaInner) {\n                    fragAcc = fc;\n                }\n                else {\n                    let fo : f32 = (1.0 - falloff(angleX, thetaInner, thetaOuter));\n                    fragAcc = fo * fc;\n                }\n            }\n        }\n\n        fragColor += fragAcc;\n    }\n\n    return fragColor;\n}\n\nfn calculateFatt(falloffType : f32, falloffFunc : vec3<f32>, distance : f32) -> f32 {\n    // 0 is constant, 1 is linear, 2 is quadratic\n    var fatt : f32;\n\n    if (falloffType == 0) {\n        fatt = 1.0;\n    }\n    else if (falloffType == 1) {\n        fatt = min(1.0, 1.0 / (falloffFunc[0] + falloffFunc[1] * distance));\n    }\n    else if (falloffType == 2) {\n        fatt = min(1.0, 1.0 / (falloffFunc[0] + falloffFunc[1] * distance\n                + falloffFunc[2] * pow(distance, 2)));\n    }\n\n    return fatt;\n}\n\nfn falloff(x : f32, thetaInner : f32, thetaOuter : f32) -> f32 {\n    let param : f32 = (x - thetaInner) / (thetaOuter - thetaInner);\n    return -2.0 * pow(param, 3) + 3.0 * pow(param, 2);\n}"},523:(t,e,n)=>{n.r(e),n.d(e,{default:()=>a});const a="\nstruct lightSource {\n    dir : vec3<f32>,\n    sourceType : f32,\n    color : vec3<f32>,\n    angle : f32,\n    pos : vec3<f32>,\n    penumbra : f32,\n    falloffFunc : vec3<f32>,\n    falloffType : f32,\n    range : f32\n}\n\nstruct lightData {\n    lightCount : i32,\n    lightSources : array<lightSource>\n}\n\nstruct materialData {\n    ka : vec3<f32>,\n    shininess : f32,\n    ks : vec3<f32>,\n    kd : vec3<f32>,\n    emissive : vec3<f32>,\n}\n\n@binding(0) @group(1) var<storage, read> lightDataBuffer : lightData;\n@binding(1) @group(1) var<uniform> wsCamera : vec3<f32>;\n@binding(0) @group(2) var<uniform> material : materialData;\n\n@binding(0) @group(3) var Texture : texture_2d<f32>;\n@binding(1) @group(3) var Sampler : sampler;\n\n@fragment\nfn fs_phong_texture(@location(0) wsPosition : vec4<f32>, @location(1) wsNormal : vec4<f32>,\n    @location(2) texCoord : vec2<f32>) -> @location(0) vec4<f32> {\n\n    let baseColor = textureSample(Texture, Sampler, texCoord);\n\n    // 1 is directional light, 2 is point light, 3 is spot light\n\n    let normal : vec3<f32> = normalize(vec3<f32>(wsNormal.x, wsNormal.y, wsNormal.z));\n    let position : vec3<f32> = vec3<f32>(wsPosition.x, wsPosition.y, wsPosition.z);\n\n    var fragColor : vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 1.0);\n    fragColor += vec4<f32>(material.ka.r, material.ka.g, material.ka.b, 0.0);\n    fragColor += vec4<f32>(material.emissive.r, material.emissive.g, material.emissive.b, 0.0);\n    var fragAcc : vec4<f32> = vec4<f32>(0.0, 0.0, 0.0, 0.0);\n\n    for (var i = 0; i < lightDataBuffer.lightCount; i++) {\n        let light : lightSource = lightDataBuffer.lightSources[i];\n\n        if (light.sourceType == 1) {\n            let dirToLight : vec3<f32> = normalize(-light.dir);\n            let diff : vec3<f32> = material.kd * clamp(dot(normal, dirToLight), 0.0, 1.0);\n\n            let reflectedLight : vec3<f32> = normalize(reflect(-dirToLight, normal));\n            let dirToCam : vec3<f32> = normalize(wsCamera - position);\n            var spec : vec3<f32>;\n            if (material.shininess == 0) {\n                spec = material.ks;\n            }\n            else {\n                spec = material.ks * pow(clamp(dot(reflectedLight, dirToCam), 0.0, 1.0), material.shininess);\n            }\n\n            fragAcc = vec4<f32>(clamp(light.color * (diff + spec),\n                vec3<f32>(0.0, 0.0, 0.0), vec3<f32>(1.0, 1.0, 1.0)), 0);\n        }\n\n        else if (light.sourceType == 2) {\n            let distance : f32 = distance(light.pos, position);\n            if (distance > light.range) {\n                continue;\n            }\n\n            let dirToLight : vec3<f32> = normalize(light.pos - position);\n            let diff : vec3<f32> = material.kd * clamp(dot(normal, dirToLight), 0.0, 1.0);\n\n            let fatt : f32 = calculateFatt(light.falloffType, light.falloffFunc, distance);\n\n            let reflectedLight : vec3<f32> = normalize(reflect(-dirToLight, normal));\n            let dirToCam : vec3<f32> = normalize(wsCamera - position);\n            var spec : vec3<f32>;\n            if (material.shininess == 0) {\n                spec = material.ks;\n            }\n            else {\n                spec = material.ks * pow(clamp(dot(reflectedLight, dirToCam), 0.0, 1.0), material.shininess);\n            }\n\n            fragAcc = fatt * vec4<f32>(clamp(light.color * (diff + spec),\n                vec3<f32>(0.0, 0.0, 0.0), vec3<f32>(1.0, 1.0, 1.0)), 0);\n        }\n\n        else if (light.sourceType == 3) {\n            let distance : f32 = distance(light.pos, position);\n            if (distance > light.range) {\n                continue;\n            }\n\n            let dirToLight : vec3<f32> = normalize(light.pos - position);\n            let diff : vec3<f32> = material.kd * clamp(dot(normal, dirToLight), 0.0, 1.0);\n\n            let fatt : f32 = calculateFatt(light.falloffType, light.falloffFunc, distance);\n\n            let reflectedLight : vec3<f32> = normalize(reflect(-dirToLight, normal));\n            let dirToCam : vec3<f32> = normalize(wsCamera - position);\n            var spec : vec3<f32>;\n            if (material.shininess == 0) {\n                spec = material.ks;\n            }\n            else {\n                spec = material.ks * pow(clamp(dot(reflectedLight, dirToCam), 0.0, 1.0), material.shininess);\n            }\n\n            let lightDir : vec3<f32> = normalize(light.dir);\n\n            var angleX : f32 = max(0, dot(lightDir, -dirToLight));\n            angleX = acos(angleX);\n            let thetaOuter : f32 = light.angle;\n            let thetaInner : f32 = (light.angle - light.penumbra);\n\n            if (angleX <= thetaOuter) {\n                let fc : vec4<f32> = fatt * vec4<f32>(clamp(light.color * (diff + spec),\n                    vec3<f32>(0.0, 0.0, 0.0), vec3<f32>(1.0, 1.0, 1.0)), 0);\n\n                if (angleX <= thetaInner) {\n                    fragAcc = fc;\n                }\n                else {\n                    let fo : f32 = (1.0 - falloff(angleX, thetaInner, thetaOuter));\n                    fragAcc = fo * fc;\n                }\n            }\n        }\n\n        fragAcc *= baseColor;\n        fragColor += fragAcc;\n    }\n\n    return vec4<f32>(fragColor.rgb, baseColor.a);\n}\n\nfn calculateFatt(falloffType : f32, falloffFunc : vec3<f32>, distance : f32) -> f32 {\n    // 0 is constant, 1 is linear, 2 is quadratic\n    var fatt : f32;\n\n    if (falloffType == 0) {\n        fatt = 1.0;\n    }\n    else if (falloffType == 1) {\n        fatt = min(1.0, 1.0 / (falloffFunc[0] + falloffFunc[1] * distance));\n    }\n    else if (falloffType == 2) {\n        fatt = min(1.0, 1.0 / (falloffFunc[0] + falloffFunc[1] * distance\n                + falloffFunc[2] * pow(distance, 2)));\n    }\n\n    return fatt;\n}\n\nfn falloff(x : f32, thetaInner : f32, thetaOuter : f32) -> f32 {\n    let param : f32 = (x - thetaInner) / (thetaOuter - thetaInner);\n    return -2.0 * pow(param, 3) + 3.0 * pow(param, 2);\n}"},420:(t,e,n)=>{n.r(e),n.d(e,{default:()=>a});const a="\nstruct lightSource {\n    dir : vec3<f32>,\n    sourceType : f32,\n    color : vec3<f32>,\n    angle : f32,\n    pos : vec3<f32>,\n    penumbra : f32,\n    falloffFunc : vec3<f32>,\n    falloffType : f32,\n    range : f32\n}\n\nstruct lightData {\n    lightCount : i32,\n    lightSources : array<lightSource>\n}\n\nstruct materialData {\n    emissive : vec3<f32>,\n}\n\n@binding(0) @group(1) var<storage, read> lightDataBuffer : lightData;\n@binding(1) @group(1) var<uniform> wsCamera : vec3<f32>;\n@binding(0) @group(2) var<uniform> material : materialData;\n\n@fragment\nfn fs_simple(@location(0) wsPosition : vec4<f32>, @location(1) wsNormal : vec4<f32>,\n    @location(2) texCoord : vec2<f32>) -> @location(0) vec4<f32> {\n\n    return vec4<f32>(material.emissive.r, material.emissive.g, material.emissive.b, 1.0);\n}"},858:(t,e,n)=>{n.r(e),n.d(e,{default:()=>a});const a="\nstruct lightSource {\n    dir : vec3<f32>,\n    sourceType : f32,\n    color : vec3<f32>,\n    angle : f32,\n    pos : vec3<f32>,\n    penumbra : f32,\n    falloffFunc : vec3<f32>,\n    falloffType : f32,\n    range : f32\n}\n\nstruct lightData {\n    lightCount : i32,\n    lightSources : array<lightSource>\n}\n\nstruct materialData {\n    emissive : vec3<f32>,\n}\n\n@binding(0) @group(1) var<storage, read> lightDataBuffer : lightData;\n@binding(1) @group(1) var<uniform> wsCamera : vec3<f32>;\n@binding(0) @group(2) var<uniform> material : materialData;\n\n@binding(0) @group(3) var Texture : texture_2d<f32>;\n@binding(1) @group(3) var Sampler : sampler;\n\n@fragment\nfn fs_simple_texture(@location(0) wsPosition : vec4<f32>, @location(1) wsNormal : vec4<f32>,\n    @location(2) texCoord : vec2<f32>) -> @location(0) vec4<f32> {\n\n    let baseColor = textureSample(Texture, Sampler, texCoord);\n\n    var fragColor = vec4<f32>(0.0, 0.0, 0.0, 1.0);\n    fragColor += vec4<f32>(material.emissive.r, material.emissive.g, material.emissive.b, 0.0);\n\n    fragColor += vec4<f32>(baseColor.rgb, 0.0);\n\n    return vec4<f32>(fragColor.rgb, baseColor.a);\n\n}"},96:(t,e,n)=>{n.r(e),n.d(e,{default:()=>a});const a="\nstruct TransformData {\n    viewProjectionMatrix : mat4x4<f32>\n}\n\nstruct ObjectData {\n    model : array<mat4x4<f32>>,\n}\n\n//struct NormalData {\n//    model3 : array<mat3x3<f32>>\n//}\n\n@binding(0) @group(0) var<uniform> transformUBO : TransformData;\n@binding(1) @group(0) var<storage, read> objects : ObjectData;\n//@binding(2) @group(0) var<storage, read> normals : NormalData;\n\nstruct Fragment {\n    @builtin(position) position : vec4<f32>,\n    @location(0) wsPosition : vec4<f32>,\n    @location(1) wsNormal : vec4<f32>,\n    @location(2) texCoord : vec2<f32>\n}\n\n@vertex\nfn vs_main(@builtin(instance_index) ID : u32, @location(0) vertexPosition : vec3<f32>,\n    @location(1) vertexNormal : vec3<f32>, @location(2) texCoord : vec2<f32>) -> Fragment {\n\n    var output : Fragment;\n\n    var mvp : mat4x4<f32> = transformUBO.viewProjectionMatrix * objects.model[ID];\n\n    output.position = mvp * vec4<f32>(vertexPosition, 1.0);\n\n    output.wsPosition = objects.model[ID] * vec4<f32>(vertexPosition, 1.0);\n\n    let model3 : mat3x3<f32> = mat3x3<f32>(objects.model[ID][0].xyz, objects.model[ID][1].xyz, objects.model[ID][2].xyz);\n    output.wsNormal = vec4<f32>(normalize(model3 * vertexNormal), 0.0);\n\n    output.texCoord = texCoord;\n\n    return output;\n}\n"}},e={};function n(a){var r=e[a];if(void 0!==r)return r.exports;var i=e[a]={exports:{}};return t[a].call(i.exports,i,i.exports,n),i.exports}n.d=(t,e)=>{for(var a in e)n.o(e,a)&&!n.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:e[a]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{const t=n(632),e=n(498),a=n(646),r=n(699),i=n(594),s=n(524),o=n(616),h=n(237),u=n(810),l=n(797),f=n(831),c=n(825),d=n(834),m=document.getElementById("gfx-main");let p=window.innerWidth,v=window.innerHeight;m.width=p,m.height=v/2,m.style.left="0px",m.style.top="0px",m.style.position="absolute",window.onresize=function(){p=window.innerWidth,v=window.innerHeight/2,m.width=p,m.height=v,location.reload()};const M=new t.WebGPURenderer(m),g=M.Initialize(),b=new i.FrustumViewCamera(45,m.width/m.height,.1,1e3);b.position=[0,0,20],b.lookAt([0,-5,0]);const x=new e.Scene(b),y=new h.PointLight(new s.Color(.5,.9,.5),.5);y.translateXYZ([4,1,0]),x.addChild(y);const C=new d.SpotLight(new s.Color(.5,.5,.8),1,[0,0,0],void 0,void 0,void 0,Math.PI,Math.PI/6);C.position=[-2,0,5],x.addChild(C);const w=new u.Plane(20,20,8,8),D=new o.PhongMaterial(new s.Color(.7,.7,.7)),B=new r.Mesh(w,D);B.translateY(-5),B.rotateX(-Math.PI/2),x.addChild(B);const P=new f.Group,T=new a.Sphere(1,32,32),S=new a.Sphere(1,32,32),A=new a.Sphere(1,32,32),L=new l.SimpleMaterial(new s.Color(.8,0,0)),O=new c.NormalMaterial,j=new r.Mesh(T,L),_=new r.Mesh(S,O),V=new r.Mesh(A,D);j.translateX(-4),_.translateX(4),P.addChild(j),P.addChild(_),P.addChild(V),x.addChild(P);let F=-.1;P.translateY(F);const I=()=>{(P.children[0].position[1]>0||P.children[0].position[1]<-4)&&(F=-F,P.translateY(2*F)),P.transformed=!0,M.render(x),requestAnimationFrame(I)};g.then((()=>{I()}))})()})();